/*! For license information please see main.37f14ada.chunk.js.LICENSE.txt */
(this["webpackJsonplunch-wpa"]=this["webpackJsonplunch-wpa"]||[]).push([[0],{167:function(e,t,n){},214:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(23),s=n.n(r),i=(n(167),n(15)),o=n.n(i),l=n(20),j=(n(169),n(19)),d=n(29),u=n(11),h=n(12),p=n(14),b=n(13),O=n(133),x=n(34),m=n(1),f=function(e){Object(p.a)(n,e);var t=Object(b.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){var e={url:x.docRoot+"status.json"};return Object(m.jsx)(O.Offline,{polling:e,children:Object(m.jsx)("p",{style:{textAlign:"center"},className:"p-3 mb-2 bg-danger text-white",children:"\u96e2\u7dda\u4e2d\uff0c\u8acb\u6aa2\u5bdf\u60a8\u7684\u9023\u7dda\u72c0\u6cc1"})})}}]),n}(c.a.Component),v=n(67),g=n(276),y=n(277),w=n(269),k=n(17),S=n(270),T=n(251),N=n(75),C=n.n(N),I=function(e){Object(p.a)(n,e);var t=Object(b.a)(n);function n(e){var a;Object(u.a)(this,n),a=t.call(this,e);var c=(new k.a).getAll(),r=[];return c.isGoogle?r.push(!0):r.push(!1),c.isSells?r.push(!0):r.push(!1),c.session?r.push(!0):r.push(!1),a.state={isGoogle:r[0],isSells:r[1],isLoggedIn:r[2],username:c.userName||"Anonymous",searchTerm:""},a.handleSearchTermChange=a.handleSearchTermChange.bind(Object(v.a)(a)),a.searchProduct=a.searchProduct.bind(Object(v.a)(a)),a}return Object(h.a)(n,[{key:"searchProduct",value:function(){this.props.location.pathname.indexOf("query")>-1?(this.props.history.replace("/query?q="+this.state.searchTerm),this.props.history.go(0)):this.props.history.push("/query?q="+this.state.searchTerm)}},{key:"handleSearchTermChange",value:function(e){this.setState({searchTerm:e.target.value})}},{key:"render",value:function(){var e="\u55e8! "+this.state.username;return Object(m.jsx)(c.a.Fragment,{children:Object(m.jsxs)(g.a,{bg:"light",expand:"lg",collapseOnSelect:!0,children:[Object(m.jsx)(g.a.Brand,{href:"/",children:"\u7f8e\u5ee3\u8a02\u9910\u7cfb\u7d71"}),Object(m.jsx)(g.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(m.jsxs)(g.a.Collapse,{id:"basic-navbar-nav",children:[Object(m.jsxs)(y.a,{className:"mr-auto",children:[Object(m.jsx)(y.a.Link,{href:"#/restaurant",children:"\u9910\u5ef3"}),this.state.isSells&&Object(m.jsxs)(w.a,{title:"\u5546\u5bb6\u7ba1\u7406",id:"basic-nav-dropdown",children:[Object(m.jsx)(w.a.Item,{href:"#/config/menu",children:"\u83dc\u55ae\u8a2d\u5b9a"}),Object(m.jsx)(w.a.Item,{as:j.b,to:"/service",children:"\u5ba2\u670d\u670d\u52d9"}),Object(m.jsx)(w.a.Item,{as:j.b,to:"/booked",children:"\u51fa\u9910"})]}),Object(m.jsxs)(w.a,{title:"\u76f8\u95dc\u9023\u7d50",id:"basic-nav-dropdown",children:[Object(m.jsx)(w.a.Item,{href:"https://sites.google.com/view/tnfshsu/",rel:"noreferrer noopener",target:"_blank",children:"\u5b78\u806f\u6703"}),Object(m.jsx)(w.a.Item,{href:"https://tnfsacec.github.io",rel:"noreferrer noopener",target:"_blank",children:"\u9078\u59d4\u6703"})]}),Object(m.jsx)(S.a,{value:this.state.searchTerm,onChange:this.handleSearchTermChange,id:"term",label:"\u641c\u5c0b\u60f3\u5403\u7684",variant:"outlined",size:"small",InputProps:{endAdornment:Object(m.jsx)(T.a,{onClick:this.searchProduct,children:Object(m.jsx)(C.a,{})})}})]}),this.state.isLoggedIn?Object(m.jsxs)(w.a,{title:e,id:"basic-nav-dropdown",children:[Object(m.jsx)(w.a.Item,{href:"#/history",children:"\u6b77\u53f2\u7d00\u9304"}),Object(m.jsx)(w.a.Item,{href:"#/settings",children:"\u8a2d\u5b9a"}),Object(m.jsx)(w.a.Item,{href:"#/profile",children:"\u500b\u4eba\u6a94\u6848"}),Object(m.jsx)(w.a.Item,{onClick:function(){var e=new k.a;e.remove("id"),e.remove("isGoogle"),e.remove("isSells"),e.remove("session"),e.remove("userName"),e.remove("storeId"),e.remove("name"),e.set("alert","\u767b\u51fa\u6210\u529f",{path:"/"}),window.location.href="/"},children:"\u767b\u51fa"})]}):Object(m.jsxs)(y.a,{children:[Object(m.jsx)(y.a.Link,{href:"#/signup",children:"\u8a3b\u518a"}),Object(m.jsx)(y.a.Link,{href:"#/login",children:"\u767b\u5165"})]})]})]})})}}]),n}(c.a.Component),A=Object(d.h)(I),E=n(10);function P(e){var t=new k.a,n=Object(a.useState)(!1),r=Object(E.a)(n,2),s=r[0],i=r[1],o=Object(a.useState)(""),l=Object(E.a)(o,2),j=l[0],d=l[1];return Object(a.useEffect)((function(){var e=t.get("alert");void 0!==e&&(i(!0),d(e),setTimeout((function(){t.remove("alert"),i(!1)}),3e3))})),Object(m.jsx)(c.a.Fragment,{children:Object(m.jsx)("p",{className:"p-3 mb-2 bg-success text-white",hidden:!s,children:j})})}var _=n(252),B=n(253),F=n(140),q=function(e){Object(p.a)(n,e);var t=Object(b.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){return Object(m.jsxs)(c.a.Fragment,{children:[Object(m.jsx)("br",{}),Object(m.jsx)("div",{className:"p-3 mb-2 bg-dark text-white ",children:Object(m.jsxs)(_.a,{children:[Object(m.jsx)("br",{}),Object(m.jsxs)(B.a,{children:[Object(m.jsxs)(F.a,{children:[Object(m.jsx)(j.b,{to:"/privacy",children:"\u96b1\u79c1\u6b0a\u8072\u660e"}),Object(m.jsx)("br",{}),Object(m.jsx)(j.b,{to:"/COC",children:"\u884c\u70ba\u6e96\u5247"}),Object(m.jsx)("br",{}),Object(m.jsx)(j.b,{to:"/feedback",children:"\u610f\u898b\u53cd\u994b"})]}),Object(m.jsxs)(F.a,{children:["\u95dc\u65bc\u6211\u5011\uff1a",Object(m.jsx)("br",{}),Object(m.jsx)("a",{href:"https://sivir.pw",rel:"noreferrer noopener",target:"_blank",children:"Milliax"}),"\u3001",Object(m.jsx)("a",{href:"https://hsuan.app/",rel:"noreferrer noopener",target:"_blank",children:"Hsuan1117"}),"\u3001",Object(m.jsx)("a",{href:"https://neodoggy.github.io/",rel:"noreferrer noopener",target:"_blank",children:"Neodoggy"}),Object(m.jsx)("br",{}),Object(m.jsx)("br",{}),Object(m.jsxs)("span",{children:["version: ",x.version]})]})]})]})})]})}}]),n}(c.a.Component),R=n(65),D=function(e){Object(p.a)(n,e);var t=Object(b.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){return Object(m.jsxs)(R.a,{children:[Object(m.jsxs)(R.a.Item,{children:[Object(m.jsx)("img",{className:"d-block w-100",src:"https://media.wired.com/photos/598e35fb99d76447c4eb1f28/master/pass/phonepicutres-TA.jpg",alt:"First slide"}),Object(m.jsxs)(R.a.Caption,{children:[Object(m.jsx)("h3",{children:"First slide label"}),Object(m.jsx)("p",{children:"\u5c0d\u4e0d\u8d77\u6211\u76dc\u5716"})]})]}),Object(m.jsxs)(R.a.Item,{children:[Object(m.jsx)("img",{className:"d-block w-100",src:"https://media.wired.com/photos/598e35fb99d76447c4eb1f28/master/pass/phonepicutres-TA.jpg",alt:"Second slide"}),Object(m.jsxs)(R.a.Caption,{children:[Object(m.jsx)("h3",{children:"Second slide label"}),Object(m.jsx)("p",{children:"\u5c0d\u4e0d\u8d77\u6211\u76dc\u5716"})]})]}),Object(m.jsxs)(R.a.Item,{children:[Object(m.jsx)("img",{className:"d-block w-100",src:"https://media.wired.com/photos/598e35fb99d76447c4eb1f28/master/pass/phonepicutres-TA.jpg",alt:"Third slide"}),Object(m.jsxs)(R.a.Caption,{children:[Object(m.jsx)("h3",{children:"Third slide label"}),Object(m.jsx)("p",{children:"\u5c0d\u4e0d\u8d77\u6211\u76dc\u5716"})]})]})]})}}]),n}(c.a.Component),M=n(280),z=n(254),L=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function G(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");L?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):U(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):U(t,e)}))}}function U(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}function J(){var e=Object(a.useState)(!1),t=Object(E.a)(e,2),n=t[0],c=t[1];function r(){return s.apply(this,arguments)}function s(){return(s=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G({});case 2:c(!1),window.location.reload(!0);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(a.useEffect)((function(){G({onUpdate:function(e){window.alert("\u767c\u73fe\u65b0\u7248\u672c\uff01\uff01\uff01 \u9ede\u6b64\u7acb\u5373\u66f4\u65b0"),e&&e.waiting&&e.waiting.postMessage({type:"SKIP_WAITING"}),window.location.reload()}})}),[]),Object(m.jsx)(M.a,{open:n,message:"A new version is available!",onClick:r,anchorOrigin:{vertical:"top",horizontal:"center"},action:Object(m.jsx)(z.a,{color:"inherit",size:"small",onClick:r,children:"Reload"})})}var H=function(e){Object(p.a)(n,e);var t=Object(b.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"componentDidMount",value:function(){window.scrollTo({top:0,behavior:"smooth"})}},{key:"render",value:function(){return Object(m.jsx)(c.a.Fragment,{children:Object(m.jsxs)(_.a,{children:[Object(m.jsx)(J,{}),Object(m.jsx)(D,{})]})})}}]),n}(c.a.Component),W=n(255),K=n(141),Z=n.n(K),V=function(e){Object(p.a)(n,e);var t=Object(b.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){var e=x.googleCloudPlatformId+".apps.googleusercontent.com",t=function(e){console.log(JSON.stringify(e));var t={token:e.accessToken};fetch("https://lunchapi.hsuan.app/api/google",{method:"POST",body:JSON.stringify(t),headers:new Headers({"Content-Type":"application/json",Accept:"application/json"})}).then((function(e){return e.ok?e.json():e.text().then((function(e){throw new Error(e)}))})).catch((function(e){console.log(e.message);var t=JSON.parse(e.message);window.alert("".concat(t.message,"\n\u8207\u4f3a\u670d\u5668\u9023\u7dda\u932f\u8aa4\uff0c\u8acb\u518d\u8a66\u4e00\u6b21\n\u5982\u679c\u554f\u984c\u7121\u6cd5\u89e3\u6c7a\uff0c\u8acb\u806f\u7d61\u7ba1\u7406\u54e1"))})).then((function(t){var n;if(void 0!==e.profileObj.givenName){var a=new k.a;a.set("session",t.access_token,{path:"/"}),a.set("isGoogle","true",{path:"/"}),a.set("alert","\u767b\u5165\u6210\u529f",{path:"/"}),a.set("userName",null===e||void 0===e||null===(n=e.profileObj)||void 0===n?void 0:n.givenName,{path:"/"}),window.location.replace("/")}})).catch((function(e){console.log("Failed: ".concat(e))}))};return Object(m.jsx)(m.Fragment,{children:Object(m.jsx)(Z.a,{clientId:e,buttonText:"\u4f7f\u7528 Google \u767b\u5165",onSuccess:t,onFailure:t,hostedDomain:x.gmailSuffix,cookiePolicy:"single_host_origin"})})}}]),n}(c.a.Component);function $(){var e=new k.a,t=Object(a.useState)(!1),n=Object(E.a)(t,2),r=n[0],s=n[1],i=Object(a.useState)(""),d=Object(E.a)(i,2),u=d[0],h=d[1],p=Object(a.useState)(""),b=Object(E.a)(p,2),O=b[0],x=b[1],f=function(){var e=Object(l.a)(o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=/^\w+((-\w+)|(\.\w+))*@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z]+$/,-1!==u.search(t)){e.next=3;break}return e.abrupt("return");case 3:return s(!0),e.next=6,v();case 6:if(n=e.sent,console.log(n),"error"===n.status){e.next=11;break}return e.next=11,g(n);case 11:s(!1);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=function(){var e=Object(l.a)(o.a.mark((function e(){var t,n,a,c,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={},e.prev=1,n={email:u,password:O},"https://lunchapi.hsuan.app/api/login",e.next=6,fetch("https://lunchapi.hsuan.app/api/login",{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json",Accept:"application/json"}});case 6:return a=e.sent,e.next=9,a.json();case 9:c=e.sent,t=c,"error"!==c.status?((r=new k.a).set("session",c.access_token,{path:"/"}),r.set("alert","\u767b\u5165\u6210\u529f",{path:"/"})):window.alert("\u5e33\u865f\u6216\u5bc6\u78bc\u932f\u8aa4"),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),window.alert("\u4f3a\u670d\u5668\u5b58\u53d6\u932f\u8aa4\uff1a".concat(e.t0));case 17:return e.abrupt("return",t);case 18:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(){return e.apply(this,arguments)}}();function g(e){return y.apply(this,arguments)}function y(){return(y=Object(l.a)(o.a.mark((function t(n){var a,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"https://lunchapi.hsuan.app/api/me",t.prev=1,t.next=4,fetch("https://lunchapi.hsuan.app/api/me",{method:"GET",headers:{Accept:"application/json",Authorization:"Bearer ".concat(n.access_token)}});case 4:return a=t.sent,t.next=7,a.json();case 7:c=t.sent,e.set("userName",c.name,{path:"/"}),e.set("id",c.id,{path:"/"}),e.set("isSells",!0,{path:"/"}),void 0!==c.stores[0]&&e.set("storeId",c.stores[0].id,{path:"/"}),document.location.href="/",t.next=18;break;case 15:t.prev=15,t.t0=t.catch(1),window.alert("\u610f\u5916\u7684\u932f\u8aa4\uff1a".concat(t.t0));case 18:case"end":return t.stop()}}),t,null,[[1,15]])})))).apply(this,arguments)}return Object(a.useEffect)((function(){window.scrollTo({top:0,behavior:"smooth"})}),[]),Object(m.jsx)(c.a.Fragment,{children:Object(m.jsx)(_.a,{children:Object(m.jsxs)("form",{className:"signInBlock",children:[Object(m.jsx)("h3",{style:{textAlign:"center"},className:"p-2",children:"\u767b\u5165"}),Object(m.jsx)("center",{hidden:!r,children:Object(m.jsx)(W.a,{animation:"border"})}),Object(m.jsxs)("div",{className:"form-group",children:[Object(m.jsx)("label",{children:"\u96fb\u5b50\u90f5\u4ef6"}),Object(m.jsx)("input",{type:"email",className:"form-control",placeholder:"Enter email",value:u,onChange:function(e){h(e.target.value)},required:!0})]}),Object(m.jsxs)("div",{className:"form-group",children:[Object(m.jsx)("label",{children:"\u5bc6\u78bc"}),Object(m.jsx)("input",{type:"password",className:"form-control",placeholder:"Enter password",value:O,onChange:function(e){x(e.target.value)},required:!0})]}),Object(m.jsxs)(B.a,{children:[Object(m.jsx)(F.a,{}),Object(m.jsx)(F.a,{}),Object(m.jsx)(F.a,{children:Object(m.jsx)(j.b,{className:"btn btn-primary btn-block",onClick:f,children:"Submit"})})]}),Object(m.jsx)("hr",{}),Object(m.jsx)("label",{children:"\u5176\u4ed6\u767b\u5165\u65b9\u5f0f\uff1f"}),Object(m.jsx)("div",{className:"otherLoginMethod",children:Object(m.jsx)(V,{})})]})})})}var Q=n(278),Y=n(136),X=n(32),ee=n.n(X),te=n(246);function ne(e){var t=Object(a.useState)(""),n=Object(E.a)(t,2),r=n[0],s=n[1],i=Object(a.useState)(""),j=Object(E.a)(i,2),u=j[0],h=j[1],p=Object(a.useState)(""),b=Object(E.a)(p,2),O=b[0],x=b[1],f=Object(a.useState)(""),v=Object(E.a)(f,2),g=v[0],y=v[1],w=Object(a.useState)(""),S=Object(E.a)(w,2),T=S[0],N=S[1],C=Object(d.f)(),I="https://lunchapi.hsuan.app/api/stores/"+e.store+"/products/"+e.product;function A(){return(A=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:fetch(I,{method:"GET",headers:{Accept:"application/json"}}).then((function(e){return e.ok?e.json():e.text().then((function(e){throw new Error(e)}))})).then((function(e){x(e.price),y(e.description),s(e.name),h(e.image)})).catch((function(e){var t=JSON.parse(e.message);ee.a.fire({title:"\u932f\u8aa4!",text:"".concat(t.message,"\n\u8207\u4f3a\u670d\u5668\u9023\u7dda\u932f\u8aa4\uff0c\u8acb\u518d\u8a66\u4e00\u6b21\n\u5982\u679c\u554f\u984c\u7121\u6cd5\u89e3\u6c7a\uff0c\u8acb\u806f\u7d61\u7ba1\u7406\u54e1"),icon:"error",confirmButtonText:"Ok"}).then((function(){return C.push("/")}))}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var P=new k.a,q=P.getAll();function R(){return(R=Object(l.a)(o.a.mark((function t(){var n,a,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n="\u8acb\u78ba\u8a8d\u60a8\u7684\u8a02\u8cfc\u8cc7\u8a0a\n\u540d\u7a31\uff1a".concat(r,"\n\u552e\u50f9\uff1a").concat(O,"\n\u5176\u4ed6\u5efa\u8b70\uff1a").concat(T,"\n\u6309 OK \u9001\u51fa\uff1bcancel \u53d6\u6d88"),!window.confirm(n)){t.next=23;break}return t.prev=2,"https://lunchapi.hsuan.app/api/transactions",t.next=6,fetch("https://lunchapi.hsuan.app/api/transactions",{method:"POST",body:JSON.stringify({name:r,qty:1,store_id:e.store,product_id:e.product,comment:T,options:{}}),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(q.session)}});case 6:return a=t.sent,t.next=9,a.json();case 9:if(c=t.sent,console.log(c),!a.ok){t.next=15;break}ee.a.fire({title:"\u8a02\u8cfc\u6210\u529f!",html:"\u611f\u8b1d\u60a8\u5229\u7528\u672c\u7cfb\u7d71\u8a02\u8cfc\u7522\u54c1<br>\u8acb\u8a18\u5f97\u65bc\u9078\u53d6\u6642\u9593\u53d6\u9910\uff0c\u8b1d\u8b1d<br>"+"\u60a8\u7684\u4ea4\u6613ID\u70ba\uff1a <b>".concat(c.id,"</b>"),icon:"success",confirmButtonText:"Ok"}).then((function(){document.location.href="/"})),t.next=18;break;case 15:return t.next=17,a.text();case 17:throw t.sent;case 18:t.next=23;break;case 20:t.prev=20,t.t0=t.catch(2),ee.a.fire({title:"\u932f\u8aa4!",text:"".concat(t.t0,"\n\u8207\u4f3a\u670d\u5668\u9023\u7dda\u932f\u8aa4\uff0c\u8acb\u518d\u8a66\u4e00\u6b21\n\u5982\u679c\u554f\u984c\u7121\u6cd5\u89e3\u6c7a\uff0c\u8acb\u806f\u7d61\u7ba1\u7406\u54e1\n\u8a02\u55ae\u672a\u6210\u7acb"),icon:"error",confirmButtonText:"Ok"}).then((function(){document.location.href="/"}));case 23:case"end":return t.stop()}}),t,null,[[2,20]])})))).apply(this,arguments)}return Object(a.useEffect)((function(){!function(){A.apply(this,arguments)}();var e=P.get("isSells");void 0===P.get("session")&&ee.a.fire({icon:"error",title:"Oops...",text:"\u8acb\u5148\u767b\u5165"}).then((function(){document.location.href="/"})),"true"===e&&ee.a.fire({icon:"error",title:"Oops...",text:"\u6b64\u529f\u80fd\u5546\u5bb6\u7121\u6cd5\u4f7f\u7528"}).then((function(){document.location.href="/"}))}),[]),Object(m.jsx)(c.a.Fragment,{children:Object(m.jsxs)(_.a,{children:[Object(m.jsx)("br",{}),Object(m.jsxs)(B.a,{children:[Object(m.jsx)(F.a,{children:Object(m.jsxs)(Q.a,{children:[Object(m.jsx)(Q.a.Caption,{className:"text-center",children:Object(m.jsxs)("h1",{children:["\u9910\u9ede\uff1a",r]})}),Object(m.jsx)(Q.a.Image,{width:300,alt:"\u9910\u9ede\u7684\u7167\u7247",src:"https://lunchapi.hsuan.app/"+u,resizeMode:"contain"})]})}),Object(m.jsxs)(F.a,{children:["\u63cf\u8ff0\uff1a",g]})]}),Object(m.jsx)(B.a,{children:Object(m.jsx)(F.a,{children:Object(m.jsxs)("h5",{children:["\u5efa\u8b70\u552e\u50f9\uff1a",O]})})}),Object(m.jsxs)(B.a,{children:[Object(m.jsx)(F.a,{lg:10,children:Object(m.jsx)(te.a,{className:"form-control",placeholder:"\u7559\u8a00",rows:"5",onChange:function(e){return N(e.target.value)},value:T})}),Object(m.jsxs)(F.a,{lg:3,children:[Object(m.jsx)("br",{}),Object(m.jsx)("div",{style:{display:"flex"},children:Object(m.jsx)("div",{style:{marginLeft:"auto"},children:Object(m.jsx)(Y.a,{variant:"primary",onClick:function(){return R.apply(this,arguments)},children:"\u8a02\u8cfc"})})})]})]})]})})}var ae=function(e){Object(p.a)(n,e);var t=Object(b.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"componentDidMount",value:function(){window.scrollTo({top:0,behavior:"smooth"})}},{key:"render",value:function(){return Object(m.jsxs)(c.a.Fragment,{children:[Object(m.jsx)("h1",{style:{textAlign:"center"},children:"\u8a02\u9910"}),Object(m.jsx)(ne,{store:this.props.match.params.store,product:this.props.match.params.product})]})}}]),n}(c.a.Component),ce=n(279);var re=function(e){var t=Object(a.useState)([]),n=Object(E.a)(t,2),r=n[0],s=n[1],i=Object(a.useState)(!1),u=Object(E.a)(i,2),h=u[0],p=u[1],b=Object(d.f)(),O=Object(a.useRef)(!0),x=Object(a.useState)(!1),f=Object(E.a)(x,2),v=f[0],g=f[1],y=(new k.a).getAll();function w(){return(w=Object(l.a)(o.a.mark((function t(){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:p(!0),n="https://lunchapi.hsuan.app/api/stores/"+e.storeId+"/products",fetch(n,{method:"GET",headers:{Accept:"application/json"}}).then((function(e){return e.ok?e.json():e.text().then((function(e){throw new Error(e)}))})).catch((function(e){console.log(e.message);var t=JSON.parse(e.message);window.alert("".concat(t.message,"\n\u8207\u4f3a\u670d\u5668\u9023\u7dda\u932f\u8aa4\uff0c\u8acb\u518d\u8a66\u4e00\u6b21\n\u5982\u679c\u554f\u984c\u7121\u6cd5\u89e3\u6c7a\uff0c\u8acb\u806f\u7d61\u7ba1\u7406\u54e1")),b.push("/login")})).then((function(t){console.log(t);for(var n=0;n<t.length;++n)t[n].storeId=e.storeId;s(t),p(!1),void 0!==y.session&&g(!0)}));case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(a.useEffect)((function(){O.current&&(O.current=!1,function(){w.apply(this,arguments)}())})),Object(m.jsxs)("div",{className:"ListStore",children:[Object(m.jsx)("center",{children:Object(m.jsx)(W.a,{animation:"border",hidden:!h})}),r&&(r.length>0?r.map((function(e){return Object(m.jsxs)(ce.a,{children:[Object(m.jsx)(ce.a.Img,{variant:"top",src:e.picUrl}),Object(m.jsxs)(ce.a.Body,{style:{display:"flex"},children:[Object(m.jsxs)("div",{children:[Object(m.jsx)(ce.a.Title,{children:e.name}),Object(m.jsx)(ce.a.Text,{children:e.description})]}),Object(m.jsx)("div",{style:{marginLeft:"auto"},children:Object(m.jsx)(Y.a,{variant:"primary",as:j.b,hidden:!v,to:{pathname:"/purchase/".concat(e.storeId,"/").concat(e.id)},children:"\u7acb\u5373\u8a02\u8cfc"})})]})]},e.id)})):Object(m.jsxs)(c.a.Fragment,{children:[Object(m.jsx)("br",{}),Object(m.jsx)("h2",{style:{textAlign:"center"},children:"\u67e5\u7121\u8cc7\u6599"})]}))]})},se=function(e){Object(p.a)(n,e);var t=Object(b.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"componentDidMount",value:function(){window.scrollTo({top:0,behavior:"smooth"}),console.log(this.props.match.params)}},{key:"render",value:function(){return Object(m.jsxs)(c.a.Fragment,{children:[Object(m.jsx)("h1",{style:{textAlign:"center"},children:"\u5403\u4ec0\u9ebc"}),Object(m.jsx)(_.a,{children:Object(m.jsx)(re,{storeId:this.props.match.params.storeId})})]})}}]),n}(c.a.Component),ie=n(48),oe=n.n(ie);function le(e,t){console.log("[".concat(e.toUpperCase(),"] ").concat(t,'"'))}var je=new oe.a,de=[{name:"\u555f\u52d5\u5546\u5e97\u529f\u80fd",url:"/settings/activate"},{name:"\u8b8a\u66f4\u5546\u5e97\u540d",url:"/settings/change_name"},{name:"\u8b8a\u66f4\u5bc6\u78bc",url:"/settings/change_password"}],ue={change_name:{title:"\u8b8a\u66f4\u5546\u5e97\u540d",hint:"\u8acb\u8f38\u5165\u5546\u5e97\u540d",placeholder:"\u65b0\u5546\u5e97\u540d",submitUri:"https://lunchapi.hsuan.app/api/stores",method:"PUT",afterFetch:function(e){le("debug",e.id),je.set("storeId",e.id)}},change_password:{title:"\u8b8a\u66f4\u5bc6\u78bc",hint:"\u8acb\u8f38\u5165\u65b0\u5bc6\u78bc",placeholder:"\u65b0\u5bc6\u78bc",submitUri:"https://lunchapi.hsuan.app/api/change_password",method:"POST",return:["newpassword"]},activate:{title:"\u555f\u52d5\u5546\u5e97\u529f\u80fd",hint:"\u8acb\u8f38\u5165\u5546\u5e97\u540d",placeholder:"\u5546\u5e97\u540d",submitUri:"https://lunchapi.hsuan.app/api/stores",method:"POST",return:["name"],afterFetch:function(e){le("debug",e.id),je.set("storeId",e.id)}}};var he=function(){return de.map((function(e){return Object(m.jsx)(ce.a,{children:Object(m.jsx)(ce.a.Body,{style:{display:"flex"},children:Object(m.jsx)("div",{children:Object(m.jsx)(j.b,{to:e.url,children:e.name})})})})}))},pe=function(e){Object(p.a)(n,e);var t=Object(b.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){var e=this,t=document.location.href.split("/")[5];return Object(m.jsxs)(c.a.Fragment,{children:[ue[t]&&Object(m.jsxs)(c.a.Fragment,{children:[Object(m.jsx)("h2",{children:ue[t].title}),Object(m.jsxs)("div",{className:"form-group",children:[Object(m.jsx)("label",{children:ue[t].hint}),Object(m.jsx)("input",{id:"userInput",type:"text",className:"form-control",placeholder:ue[t].placeholder})]}),Object(m.jsx)("button",{type:"submit",className:"btn btn-primary btn-block",onClick:function(){var n=(new k.a).getAll();n.session||(window.alert("Session expired"),document.location.replace("/"));var a={method:ue[t].method,headers:{Accept:"application/json",Authorization:"Bearer ".concat(n.session),"Content-Type":"application/json"}};if("POST"===ue[t].method){for(var c={},r=0;r<ue[t].return.length;++r){var s=document.getElementById("userInput");c[ue[t].return[r]]=s.value}a.body=JSON.stringify(c)}fetch(ue[t].submitUri,a).then((function(e){return e.ok?e.json():e.text().then((function(e){throw new Error(e)}))})).then((function(n){var a;console.log(n),ee.a.fire({title:"\u6210\u529f!",text:"\u66f4\u65b0\u6210\u529f, \u6b61\u8fce".concat(null!==(a=null===n||void 0===n?void 0:n.name)&&void 0!==a?a:"","!"),icon:"success",confirmButtonText:"Ok"}).then((function(){var a,c;null===(a=ue[t])||void 0===a||null===(c=a.afterFetch)||void 0===c||c.call(a,n),e.props.history.go(0)}))})).catch((function(e){var t,n=JSON.parse(e.message).error;ee.a.fire({title:"\u932f\u8aa4!",html:"\u932f\u8aa4\uff1a ".concat(null!==(t=null===n||void 0===n?void 0:n.localizedMessage)&&void 0!==t?t:"","! <br>\n                        \u932f\u8aa4\u4ee3\u78bc\uff1a ").concat(null===n||void 0===n?void 0:n.code,"(").concat(null===n||void 0===n?void 0:n.status,")<br>\n                        \u5982\u554f\u984c\u6301\u7e8c\u767c\u751f\uff0c\u8acb\u63d0\u4f9b\u9019\u4e9b\u8cc7\u8a0a\u7d66\u5de5\u7a0b\u5e2b!\n                        "),icon:"error",confirmButtonText:"Ok"})}))},children:"\u78ba\u8a8d"})]}),!ue[t]&&t&&Object(m.jsx)("h2",{children:"\u8acb\u8f38\u5165\u5408\u6cd5\u529f\u80fd"}),!ue[t]&&!t&&Object(m.jsx)("h2",{children:"\u8acb\u9078\u53d6\u5de6\u908a\u529f\u80fd\u4ee5\u7e7c\u7e8c"})]})}}]),n}(c.a.Component),be=Object(d.h)(pe),Oe=function(e){Object(p.a)(n,e);var t=Object(b.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"componentDidMount",value:function(){window.scrollTo({top:0,behavior:"smooth"})}},{key:"render",value:function(){return Object(m.jsxs)(c.a.Fragment,{children:[Object(m.jsx)("h1",{style:{textAlign:"center"},children:"\u8a2d\u5b9a"}),Object(m.jsx)(_.a,{children:Object(m.jsxs)(B.a,{children:[Object(m.jsx)(F.a,{xs:3,children:Object(m.jsx)(he,{})}),Object(m.jsx)(F.a,{xs:7,children:Object(m.jsx)(be,{})})]})})]})}}]),n}(c.a.Component);var xe=function(){var e=Object(a.useState)([]),t=Object(E.a)(e,2),n=t[0],r=t[1],s=Object(a.useState)(!0),i=Object(E.a)(s,2),o=i[0],l=i[1];return Object(a.useEffect)((function(){!function(){var e="https://lunchapi.hsuan.app/api/stores";console.log(e),fetch(e,{method:"GET"}).then((function(e){return l(!1),e.ok?e.json():e.text().then((function(e){throw new Error(e)}))})).catch((function(e){console.log(e.message);var t=JSON.parse(e.message);window.alert("".concat(t.message,"\n\u8207\u4f3a\u670d\u5668\u9023\u7dda\u932f\u8aa4\uff0c\u8acb\u518d\u8a66\u4e00\u6b21\n\u5982\u679c\u554f\u984c\u7121\u6cd5\u89e3\u6c7a\uff0c\u8acb\u806f\u7d61\u7ba1\u7406\u54e1")),window.location.replace("/")})).then((function(e){console.log(e),r(e)}))}()}),[]),Object(m.jsxs)("div",{className:"ListStore",children:[n&&(n.length>0?n.map((function(e){return Object(m.jsxs)(ce.a,{children:[Object(m.jsx)(ce.a.Img,{variant:"top",src:e.picUrl}),Object(m.jsxs)(ce.a.Body,{style:{display:"flex"},children:[Object(m.jsxs)("div",{children:[Object(m.jsx)(ce.a.Title,{children:e.name}),Object(m.jsx)(ce.a.Text,{children:e.description})]}),Object(m.jsx)("div",{style:{marginLeft:"auto"},children:Object(m.jsx)(Y.a,{variant:"primary",as:j.b,to:{pathname:"/order/".concat(e.id)},children:"\u7acb\u5373\u67e5\u770b"})})]})]},e.id)})):Object(m.jsxs)(c.a.Fragment,{children:[Object(m.jsx)("br",{}),Object(m.jsx)("h2",{style:{textAlign:"center"},children:"\u76ee\u524d\u7121\u76f8\u95dc\u8cc7\u6599"})]})),Object(m.jsx)("center",{children:Object(m.jsx)(W.a,{animation:"border",hidden:!o})})]})},me=function(e){Object(p.a)(n,e);var t=Object(b.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"componentDidMount",value:function(){window.scrollTo({top:0,behavior:"smooth"})}},{key:"render",value:function(){return Object(m.jsxs)(c.a.Fragment,{children:[Object(m.jsx)("h1",{style:{textAlign:"center"},children:"\u9910\u5ef3"}),Object(m.jsx)(_.a,{children:Object(m.jsx)(xe,{})})]})}}]),n}(c.a.Component),fe=n(283),ve=n(256),ge=n(257),ye=n(40),we=function(){function e(){Object(u.a)(this,e),this.cookies=new k.a}return Object(h.a)(e,[{key:"call",value:function(e,t,n){for(var a in e="https://lunchapi.hsuan.app/api"+e,t.params||{})e=e.replaceAll(":"+a,t.params[a]);var c="object"===typeof t.body?JSON.stringify(t.body):null,r=new Headers(Object(ye.a)({"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(this.cookies.get("session"))},t.headers));fetch(e,{method:t.method,body:c,headers:r}).then((function(e){return e.json()})).then(n)}}]),e}(),ke=n(258);function Se(){var e=Object(a.useState)([]),t=Object(E.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(!1),s=Object(E.a)(r,2),i=s[0],j=s[1],d=new we;function u(){return h.apply(this,arguments)}function h(){return(h=Object(l.a)(o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=new k.a,n=t.getAll(),"https://lunchapi.hsuan.app/api/transactions",j(!0),fetch("https://lunchapi.hsuan.app/api/transactions",{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(n.session)}}).then((function(e){return e.ok?e.json():e.text().then((function(e){throw new Error(e)}))})).catch((function(e){console.log(e.message);var t=JSON.parse(e.message);window.alert("".concat(t.message,"\n\u8207\u4f3a\u670d\u5668\u9023\u7dda\u932f\u8aa4\uff0c\u8acb\u518d\u8a66\u4e00\u6b21\n\u5982\u679c\u554f\u984c\u7121\u6cd5\u89e3\u6c7a\uff0c\u8acb\u806f\u7d61\u7ba1\u7406\u54e1")),window.location.replace("/")})).then((function(e){console.log(e),c(e),j(!1)}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e,t){j(!0),d.call("/transactions/:transaction/rate",{method:"POST",params:{transaction:t},body:{rate:e}},(function(e){u()}))}return Object(a.useEffect)((function(){u()}),[]),Object(m.jsxs)(_.a,{children:[Object(m.jsx)(ve.a,{hidden:!i}),Object(m.jsx)("div",{className:"History",children:n&&n.length>0&&n.map((function(e){return Object(m.jsxs)(B.a,{children:[Object(m.jsx)(F.a,{sm:12,md:6,children:Object(m.jsxs)(ce.a,{children:[Object(m.jsx)(ce.a.Img,{variant:"top",src:e.picUrl}),Object(m.jsxs)(ce.a.Body,{style:{display:"flex",flexDirection:"column"},children:[Object(m.jsxs)(ce.a.Title,{children:["\u5546\u54c1\u540d\u7a31\uff1a",e.product.name]}),Object(m.jsxs)(ce.a.Title,{children:["\u91d1\u984d\uff1a",e.total]}),Object(m.jsxs)(ce.a.Text,{children:["\u7559\u8a00\uff1a",null===e.comment?"":e.comment.length>50?e.comment.slice(0,50)+" ...":e.comment]}),Object(m.jsxs)(ce.a.Text,{children:["\u8cfc\u8cb7\u65e5\u671f\uff1a",new Date(e.updated_at).toLocaleTimeString("zh-TW")]}),Object(m.jsxs)(ce.a.Text,{children:["\u8a02\u55ae\u7de8\u865f\uff1a",Object(m.jsx)("b",{children:e.id.substring(0,8)}),e.id.substr(8)]}),Object(m.jsxs)(ge.a,{container:!0,spacing:1,justify:"center",direction:"row",alignItems:"center",children:[Object(m.jsx)(ge.a,{item:!0,children:Object(m.jsx)(fe.a,{name:"rating",value:parseFloat(e.rating),onChange:function(t){return p(t.target.value,e.id)}})}),Object(m.jsx)(ge.a,{item:!0,children:Object(m.jsx)(T.a,{onClick:function(){return p(-1,e.id)},children:Object(m.jsx)(ke.a,{size:"small"})})})]})]})]})}),Object(m.jsx)(F.a,{sm:12,md:6,style:{justifyContent:"center",display:"flex"},children:Object(m.jsx)("div",{children:Object(m.jsx)("span",{style:{alignItems:"center",fontSize:"5rem",fontStyle:"bold",display:"flex",textAlign:"center"},children:e.id.substring(0,8)})})})]},e.id)}))})]})}var Te=function(e){Object(p.a)(n,e);var t=Object(b.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"componentDidMount",value:function(){window.scrollTo({top:0,behavior:"smooth"})}},{key:"render",value:function(){return Object(m.jsxs)(c.a.Fragment,{children:[Object(m.jsx)("h1",{style:{textAlign:"center"},children:"\u6b77\u53f2\u7d00\u9304"}),Object(m.jsx)(Se,{})]})}}]),n}(c.a.Component),Ne=function(e){Object(p.a)(n,e);var t=Object(b.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"componentDidMount",value:function(){window.scrollTo({top:0,behavior:"smooth"})}},{key:"render",value:function(){return Object(m.jsx)(c.a.Fragment,{children:Object(m.jsx)("h1",{style:{textAlign:"center"},children:"\u5546\u5bb6\u8a2d\u5b9a"})})}}]),n}(c.a.Component),Ce=function(e){Object(p.a)(n,e);var t=Object(b.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){return Object(m.jsx)("div",{className:"optionBar",children:Object(m.jsx)("ul",{children:Object(m.jsx)("li",{children:Object(m.jsx)(j.b,{to:"/config/menu/new",children:"\u65b0\u589e"})})})})}}]),n}(c.a.Component);function Ie(){var e=Object(a.useState)([]),t=Object(E.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(0),s=Object(E.a)(r,2),i=s[0],o=s[1],l=Object(a.useRef)(!0),d=(new k.a).getAll(),u=new we;d.storeId||ee.a.fire({title:"\u932f\u8aa4!",text:"404 (STORE_NOT_FOUND)",icon:"error",confirmButtonText:"Ok"});return Object(a.useEffect)((function(){l.current&&(l.current=!1,function(){var e="https://lunchapi.hsuan.app/api/stores/"+d.storeId+"/products";fetch(e,{method:"GET",headers:{Accept:"application/json"}}).then((function(e){return e.ok?e.json():e.text().then((function(e){throw new Error(e)}))})).catch((function(e){console.log(e.message);var t=JSON.parse(e.message);window.alert("".concat(t.message,"\n\u8207\u4f3a\u670d\u5668\u9023\u7dda\u932f\u8aa4\uff0c\u8acb\u518d\u8a66\u4e00\u6b21\n\u5982\u679c\u554f\u984c\u7121\u6cd5\u89e3\u6c7a\uff0c\u8acb\u806f\u7d61\u7ba1\u7406\u54e1")),window.location.replace("#/login")})).then((function(e){console.log(e),c(e)})),u.call("/stores/:id/promotion_quota",{params:{id:d.storeId}},(function(e){console.log(e.remain),o(e.remain)}))}())})),Object(m.jsxs)("div",{className:"storeAdded",children:[Object(m.jsxs)("div",{style:{textAlign:"right"},children:["\u5269\u4e0b\u7684\u5ba3\u50b3\u9ede\u6578\uff1a ",i,"\u9ede"]}),n&&n.length>0&&n.map((function(e){return Object(m.jsxs)(ce.a,{children:[Object(m.jsx)(ce.a.Img,{variant:"top",src:e.picUrl}),Object(m.jsxs)(ce.a.Body,{style:{display:"flex"},children:[Object(m.jsxs)("div",{children:[Object(m.jsx)(ce.a.Title,{children:e.name}),Object(m.jsx)(ce.a.Text,{children:e.description})]}),Object(m.jsx)("div",{style:{marginLeft:"auto"},children:Object(m.jsx)(Y.a,{variant:"danger",onClick:function(){return t=e.id,void ee.a.fire({title:"\u78ba\u8a8d",text:"\u78ba\u5b9a\u8981\u5c07\u5ba3\u50b3\u9ede\u6578\u7528\u65bc\u9019\u500b\u5546\u54c1\u55ce\uff1f",showCancelButton:!0,confirmButtonText:"\u78ba\u5b9a"}).then((function(e){e.isConfirmed&&u.call("/products/:id/promotion",{method:"POST",params:{id:t},body:{type:"WEIGHT"}},(function(e){console.log(e),"error"===e.status?ee.a.fire({title:"\u932f\u8aa4!",text:"\u4f3a\u670d\u5668\u932f\u8aa4("+e.error.message+")",icon:"error"}):ee.a.fire({title:"\u6210\u529f!",text:"\u6b0a\u91cd\u589e\u52a0\u6210\u529f",icon:"success"})}))}));var t},children:"\u63d0\u9ad8\u6392\u540d"})}),"\xa0",Object(m.jsx)("div",{children:Object(m.jsx)(Y.a,{variant:"primary",as:j.b,to:{pathname:"/config/advanced/".concat(e.id)},children:"\u4fee\u6539"})})]})]},e.id)}))]})}var Ae=function(e){Object(p.a)(n,e);var t=Object(b.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"componentDidMount",value:function(){window.scrollTo({top:0,behavior:"smooth"})}},{key:"render",value:function(){return Object(m.jsxs)(c.a.Fragment,{children:[Object(m.jsx)("h1",{style:{textAlign:"center"},children:"\u83dc\u55ae\u8a2d\u5b9a"}),Object(m.jsxs)(_.a,{children:[Object(m.jsx)(Ce,{}),Object(m.jsx)("br",{}),Object(m.jsx)(Ie,{})]})]})}}]),n}(c.a.Component);function Ee(e){var t=Object(a.useState)(""),n=Object(E.a)(t,2),c=n[0],r=n[1],s=Object(a.useState)(!1),i=Object(E.a)(s,2),j=i[0],u=i[1],h=Object(a.useState)(""),p=Object(E.a)(h,2),b=p[0],O=p[1],x=Object(d.f)(),f=(new k.a).getAll(),v=f.storeId,g=Object(a.useState)(""),y=Object(E.a)(g,2),w=y[0],S=y[1],T=Object(a.useState)(""),N=Object(E.a)(T,2),C=N[0],I=N[1],A=Object(a.useState)(""),P=Object(E.a)(A,2),q=P[0],R=P[1];function D(){return(D=Object(l.a)(o.a.mark((function e(){var t,n,a,c,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.getElementById("foodTitle").value,n=document.getElementById("foodSub").value,a=document.getElementById("foodPrice").value,c="https://lunchapi.hsuan.app/api/stores/"+v+"/products",r={name:t,price:a,description:n,store_id:v,image:b},e.next=7,fetch(c,{method:"POST",body:JSON.stringify(r),headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(f.session)}}).then((function(e){return e.ok?e.json():e.text().then((function(e){throw new Error(e)}))})).catch((function(e){console.log(e.message);var t=JSON.parse(e.message);window.alert("".concat(t.message,"\n\u8207\u4f3a\u670d\u5668\u9023\u7dda\u932f\u8aa4\uff0c\u8acb\u518d\u8a66\u4e00\u6b21\n\u5982\u679c\u554f\u984c\u7121\u6cd5\u89e3\u6c7a\uff0c\u8acb\u806f\u7d61\u7ba1\u7406\u54e1"))})).then((function(e){console.log(e),x.push("/config/menu")}));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(){return(M=Object(l.a)(o.a.mark((function t(){var n,a,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="https://lunchapi.hsuan.app/api/stores/"+f.storeId+"/products/"+e.product,t.prev=1,t.next=4,fetch(n,{method:"GET",headers:{Authorization:"Bearer ".concat(f.session),Accept:"application/json"}});case 4:return a=t.sent,t.next=7,a.json();case 7:c=t.sent,R(c.price),S(c.name),I(c.description),O(c.image),console.log(c),t.next=19;break;case 15:t.prev=15,t.t0=t.catch(1),window.alert("\u932f\u8aa4!!!\nerror: ".concat(t.t0,"\n\u7acb\u5373\u8fd4\u56de\u9996\u9801\n")),document.location.href="/";case 19:case"end":return t.stop()}}),t,null,[[1,15]])})))).apply(this,arguments)}return Object(a.useEffect)((function(){!function(){M.apply(this,arguments)}()}),[]),Object(m.jsx)(_.a,{children:Object(m.jsxs)("form",{className:"foodBlock",onSubmit:function(e){e.preventDefault(),function(){D.apply(this,arguments)}()},children:[Object(m.jsxs)("div",{className:"form-group",children:[Object(m.jsx)("label",{children:"\u98df\u7269\u540d"}),Object(m.jsx)("input",{type:"text",className:"form-control",placeholder:"\u6a19\u984c",value:w,onChange:function(e){return S(e.target.value)},required:!0})]}),Object(m.jsxs)("div",{className:"form-group",children:[Object(m.jsx)("label",{children:"\u50f9\u9322"}),Object(m.jsx)("input",{type:"text",className:"form-control",placeholder:"\u50f9\u9322",value:q,onChange:function(e){return R(parseInt(e.target.value))},required:!0})]}),Object(m.jsxs)("div",{className:"form-group",children:[Object(m.jsx)("label",{children:"\u526f\u6a19\u984c"}),Object(m.jsx)("input",{type:"text",className:"form-control",placeholder:"\u526f\u6a19",value:C,onChange:function(e){return I(e.target.value)},required:!0})]}),Object(m.jsx)(B.a,{children:Object(m.jsx)(F.a,{children:Object(m.jsx)("div",{className:"form-group",children:Object(m.jsxs)(Y.a,{as:"label",variant:"primary",hidden:""!==b,children:["\u4e0a\u50b3\u5716\u7247",Object(m.jsx)("input",{type:"file",name:"file",className:"upload-file",id:"file",onChange:function(e){console.log("Uploading");var t=f.storeId,n=new FileReader,a=e.target.files[0];n.onload=function(e){console.log(a),r(e.target.result);var n=new FormData;n.append("image",a),u(!0),fetch("https://lunchapi.hsuan.app/api/stores/"+t+"/images",{method:"POST",headers:{Accept:"application/json",Authorization:"Bearer ".concat(f.session)},body:n}).then((function(e){return e.ok?e.json():e.text().then((function(e){throw new Error(e)}))})).catch((function(e){console.log(e.message);var t=JSON.parse(e.message);window.alert("".concat(t.message,"\n\u8207\u4f3a\u670d\u5668\u9023\u7dda\u932f\u8aa4\uff0c\u8acb\u518d\u8a66\u4e00\u6b21\n\u5982\u679c\u554f\u984c\u7121\u6cd5\u89e3\u6c7a\uff0c\u8acb\u806f\u7d61\u7ba1\u7406\u54e1"))})).then((function(e){console.log(typeof e),O(e.result.data),window.alert(e.result.data),u(!1)}))},n.readAsDataURL(a),console.log("Uploaded")},required:!0,hidden:!0})]})})})}),Object(m.jsx)(B.a,{children:Object(m.jsx)(F.a,{children:Object(m.jsxs)("center",{children:[Object(m.jsx)(W.a,{hidden:!1===j,animation:"border"}),Object(m.jsx)("br",{}),Object(m.jsx)("a",{href:"https://lunchapi.hsuan.app/"+b,target:"_blank",hidden:!c||j,rel:"noreferrer",children:"https://lunchapi.hsuan.app/"+b}),Object(m.jsx)("br",{}),Object(m.jsx)(Q.a.Image,{width:300,src:c&&!j?"https://lunchapi.hsuan.app/"+b:"https://via.placeholder.com/300x180?text=Product+Image",resizeMode:"contain"})]})})}),Object(m.jsx)(B.a,{children:Object(m.jsx)("div",{className:"h-100 align-items-center",children:Object(m.jsx)("div",{id:"placeToAdd"})})}),Object(m.jsx)(B.a,{children:Object(m.jsx)(F.a,{children:Object(m.jsx)("button",{className:"btn btn-primary btn-block",children:"\u9001\u51fa"})})})]})})}var Pe=function(e){Object(p.a)(n,e);var t=Object(b.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"componentDidMount",value:function(){window.scrollTo({top:0,behavior:"smooth"})}},{key:"render",value:function(){return Object(m.jsxs)(c.a.Fragment,{children:[Object(m.jsx)("h1",{style:{textAlign:"center"},children:"\u9032\u968e\u8a2d\u5b9a"}),Object(m.jsx)(Ee,{product:this.props.match.params.product})]})}}]),n}(c.a.Component),_e=function(e){Object(p.a)(n,e);var t=Object(b.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"componentDidMount",value:function(){window.scrollTo({top:0,behavior:"smooth"});var e=new RegExp("\n","g"),t=x.docRoot+"title.json";fetch(t).then((function(e){return e.json()})).then((function(e){document.getElementById("title").innerHTML=e.title}));var n=x.docRoot+"coc.json";fetch(n).then((function(e){return e.json()})).then((function(t){for(var n=0;n<t.title.length;++n){var a=document.createElement("H2");a.textContent=t.title[n],document.getElementById("COC").appendChild(a),document.getElementById("COC").innerHTML+="<p>"+t.context[n].replace(e,"<br>")+"</p>"}var c=document.createElement("H3");c.innerText="\u6700\u5f8c\u66f4\u65b0\u65e5\u671f\uff1a"+t.date,document.getElementById("COC").appendChild(c)}))}},{key:"render",value:function(){return Object(m.jsxs)(c.a.Fragment,{children:[Object(m.jsx)("h1",{style:{textAlign:"center"},children:"\u884c\u70ba\u6e96\u5247"}),Object(m.jsxs)(_.a,{children:[Object(m.jsx)("br",{}),Object(m.jsx)("p",{id:"title"}),Object(m.jsx)("div",{id:"COC"})]})]})}}]),n}(c.a.Component),Be=function(e){Object(p.a)(n,e);var t=Object(b.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"componentDidMount",value:function(){window.scrollTo({top:0,behavior:"smooth"});var e=new RegExp("\n","g"),t=x.docRoot+"title.json";fetch(t).then((function(e){return e.json()})).then((function(e){document.getElementById("title").innerHTML=e.title}));var n=x.docRoot+"privacy.json";fetch(n).then((function(e){return e.json()})).then((function(t){for(var n=0;n<t.title.length;++n){var a=document.createElement("H2");a.textContent=t.title[n],document.getElementById("policy").appendChild(a),document.getElementById("policy").innerHTML+="<p>"+t.context[n].replace(e,"<br>")+"</p>"}var c=document.createElement("H3");c.innerText="\u6700\u5f8c\u66f4\u65b0\u65e5\u671f\uff1a"+t.date,document.getElementById("policy").appendChild(c)}))}},{key:"render",value:function(){return Object(m.jsxs)(c.a.Fragment,{children:[Object(m.jsx)("h1",{style:{textAlign:"center"},children:"\u96b1\u79c1\u6b0a\u8072\u660e"}),Object(m.jsxs)(_.a,{children:[Object(m.jsx)("br",{}),Object(m.jsx)("p",{id:"title"}),Object(m.jsx)("div",{id:"policy"})]})]})}}]),n}(c.a.Component),Fe=function(e){Object(p.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={loading:!1},a}return Object(h.a)(n,[{key:"render",value:function(){var e=this;return Object(m.jsx)(c.a.Fragment,{children:Object(m.jsx)(_.a,{children:Object(m.jsxs)("form",{className:"signInBlock",children:[Object(m.jsx)("h3",{style:{textAlign:"center"},children:"\u5e33\u865f\u8a3b\u518a"}),Object(m.jsxs)("div",{className:"form-group",children:[Object(m.jsx)("label",{children:"\u555f\u52d5\u78bc"}),Object(m.jsx)("input",{id:"activateToken",type:"text",className:"form-control",placeholder:"Enter the activate code",required:!0})]}),Object(m.jsxs)("div",{className:"form-group",children:[Object(m.jsx)("label",{children:"\u96fb\u5b50\u90f5\u4ef6"}),Object(m.jsx)("input",{id:"userInputEmail",type:"email",className:"form-control",placeholder:"Enter email",required:!0})]}),Object(m.jsxs)("div",{className:"form-group",children:[Object(m.jsx)("label",{children:"\u5bc6\u78bc"}),Object(m.jsx)("input",{id:"userInputPasswd",type:"password",className:"form-control",placeholder:"Enter password",required:!0})]}),Object(m.jsxs)("div",{className:"form-group",children:[Object(m.jsx)("label",{children:"\u5bc6\u78bc\u78ba\u8a8d"}),Object(m.jsx)("input",{id:"userInputPasswdVerification",type:"password",className:"form-control",placeholder:"Enter password",required:!0})]}),Object(m.jsxs)("div",{className:"form-group",children:[Object(m.jsx)("label",{children:"\u4f7f\u7528\u8005\u540d\u7a31"}),Object(m.jsx)("input",{id:"username",type:"text",className:"form-control",placeholder:"Enter the username",required:!0})]}),Object(m.jsxs)(B.a,{children:[Object(m.jsx)(F.a,{}),Object(m.jsx)(F.a,{}),Object(m.jsx)(F.a,{children:this.state.loading?Object(m.jsx)(j.b,{className:"btn btn-primary btn-block",type:"submit",children:"\u8acb\u7a0d\u5f8c"}):Object(m.jsx)(j.b,{className:"btn btn-primary btn-block",type:"submit",onClick:function(){var t=document.getElementById("userInputPasswd"),n=document.getElementById("userInputPasswdVerification"),a=document.getElementById("userInputEmail"),c=document.getElementById("activateToken"),r=document.getElementById("username");if(t.value&&n.value&&a.value&&c.value&&r.value){if(t.value!==n.value)return window.alert("\u5bc6\u78bc\u8207\u5bc6\u78bc\u9a57\u8b49\u4e0d\u7b26"),t.value="",void(n.value="");if(-1!==a.value.search(/^\w+((-\w+)|(\.\w+))*@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z]+$/)){var s={email:a.value,name:r.value,password:t.value,registration_code:c.value};e.setState({loading:!0}),fetch("https://lunchapi.hsuan.app/api/register",{method:"POST",body:JSON.stringify(s),headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){return e.ok?e.json():e.text().then((function(e){throw new Error(e)}))})).catch((function(t){console.log(t.message);var n=JSON.parse(t.message);window.alert("".concat(n.message,"\n\u8207\u4f3a\u670d\u5668\u9023\u7dda\u932f\u8aa4\uff0c\u8acb\u518d\u8a66\u4e00\u6b21\n\u5982\u679c\u554f\u984c\u7121\u6cd5\u89e3\u6c7a\uff0c\u8acb\u806f\u7d61\u7ba1\u7406\u54e1")),e.setState({loading:!1})})).then((function(t){(new k.a).set("alert","\u8a3b\u518a\u6210\u529f",{path:"/"}),window.location.replace("/login"),e.setState({loading:!1})})).catch((function(t){console.log("Failed: ".concat(t)),e.setState({loading:!1})})).then(e.setState({loading:!1}))}}},children:"\u9001\u51fa"})})]})]})})})}}]),n}(c.a.Component),qe=function(e){Object(p.a)(n,e);var t=Object(b.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){return Object(m.jsx)(c.a.Fragment,{children:Object(m.jsx)(Fe,{})})}}]),n}(c.a.Component),Re=n(272),De=function(e){Object(p.a)(n,e);var t=Object(b.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){return Object(m.jsxs)(c.a.Fragment,{children:[Object(m.jsx)("h1",{style:{textAlign:"center"},children:"\u610f\u898b\u53cd\u994b"}),Object(m.jsx)(_.a,{children:Object(m.jsxs)(Re.a,{children:[Object(m.jsxs)(Re.a.Group,{children:[Object(m.jsx)(Re.a.Label,{children:"\u66b1\u7a31\uff1a"}),Object(m.jsx)(Re.a.Control,{id:"nickName",type:"text",placeholder:"\u5c0f/\u5927\u660e",required:!0}),Object(m.jsx)(Re.a.Text,{className:"text-muted",children:"\u6211\u5011\u7d55\u5c0d\u4e0d\u6703\u56e0\u70ba\u4f60\u7684\u66b1\u7a31\u5f88\u667a\u969c\u5c31\u4e0d\u7406\u4f60"})]}),Object(m.jsxs)(Re.a.Group,{children:[Object(m.jsx)(Re.a.Label,{children:"\u554f\u984c\uff1a"}),Object(m.jsx)(Re.a.Control,{as:"textarea",rows:"5",id:"question",required:!0})]}),Object(m.jsx)(Y.a,{variant:"primary",type:"submit",onClick:function(){var e=document.getElementById("nickName"),t=document.getElementById("question");if(""!==e.value&&""!==t.value){var n=new FormData;n.append("entry.1239005013",e.value),n.append("entry.664971969",t.value);fetch("https://docs.google.com/forms/u/0/d/e/1FAIpQLSdppxPAZlPuLMgelWDJ1wP6fIB4vScvivNrn3BZ9g7etGklCA/formResponse",{method:"POST",mode:"no-cors",body:n}).then((function(e){return e.ok?e.json():e.text().then((function(e){throw new Error(e)}))})).catch((function(e){console.log(e.message);var t=JSON.parse(e.message);window.alert("".concat(t.message,"\n\u8207\u4f3a\u670d\u5668\u9023\u7dda\u932f\u8aa4\uff0c\u8acb\u518d\u8a66\u4e00\u6b21\n\u5982\u679c\u554f\u984c\u7121\u6cd5\u89e3\u6c7a\uff0c\u8acb\u806f\u7d61\u7ba1\u7406\u54e1"))})).then((function(e){window.alert("message sent"),console.log(e)})),window.alert("\u5df2\u7d93\u6536\u5230\u4f60\u7684\u8a0a\u606f\u4e86\n\u6211\u5011\u5c07\u6703\u52aa\u529b\u6539\u9032"),(new k.a).set("alert","\u50b3\u9001\u6210\u529f",{path:"/"}),document.location.replace("#/feedback")}},children:"\u9001\u51fa"})]})})]})}}]),n}(c.a.Component),Me=function(e){Object(p.a)(n,e);var t=Object(b.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){return Object(m.jsx)("div",{className:"optionBar",hidden:!0,children:Object(m.jsx)("ul",{children:Object(m.jsx)("li",{children:Object(m.jsxs)(Y.a,{variant:"dark",onClick:function(){var e=x.project+"#/config/new/option";window.open(e,"","location=no,height=500,width=400,top=100,left=300").body="\u529f\u80fd\u672a\u958b\u653e"},children:[Object(m.jsx)("i",{className:"fa fa-plus","aria-hidden":"true"}),"\u65b0\u589e\u9078\u9805"]})})})})}}]),n}(c.a.Component);function ze(){var e=Object(a.useState)(""),t=Object(E.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(!1),s=Object(E.a)(r,2),i=s[0],j=s[1],u=Object(a.useState)(""),h=Object(E.a)(u,2),p=h[0],b=h[1],O=Object(d.f)(),x=(new k.a).getAll(),f=x.storeId;function v(){return(v=Object(l.a)(o.a.mark((function e(){var t,n,a,c,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.getElementById("foodTitle").value,n=document.getElementById("foodSub").value,a=document.getElementById("foodPrice").value,c="https://lunchapi.hsuan.app/api/stores/"+f+"/products",r={name:t,price:a,description:n,store_id:f,image:p},e.next=7,fetch(c,{method:"POST",body:JSON.stringify(r),headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(x.session)}}).then((function(e){return e.ok?e.json():e.text().then((function(e){throw new Error(e)}))})).catch((function(e){console.log(e.message);var t=JSON.parse(e.message);window.alert("".concat(t.message,"\n\u8207\u4f3a\u670d\u5668\u9023\u7dda\u932f\u8aa4\uff0c\u8acb\u518d\u8a66\u4e00\u6b21\n\u5982\u679c\u554f\u984c\u7121\u6cd5\u89e3\u6c7a\uff0c\u8acb\u806f\u7d61\u7ba1\u7406\u54e1"))})).then((function(e){console.log(e),O.push("/config/menu")}));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(m.jsxs)("form",{className:"foodBlock",onSubmit:function(e){e.preventDefault(),function(){v.apply(this,arguments)}()},children:[Object(m.jsxs)("div",{className:"form-group",children:[Object(m.jsx)("label",{children:"\u98df\u7269\u540d"}),Object(m.jsx)("input",{id:"foodTitle",type:"text",className:"form-control",placeholder:"\u6a19\u984c",required:!0})]}),Object(m.jsxs)("div",{className:"form-group",children:[Object(m.jsx)("label",{children:"\u50f9\u9322"}),Object(m.jsx)("input",{id:"foodPrice",type:"number",className:"form-control",placeholder:"\u50f9\u9322",required:!0})]}),Object(m.jsxs)("div",{className:"form-group",children:[Object(m.jsx)("label",{children:"\u526f\u6a19\u984c"}),Object(m.jsx)("input",{id:"foodSub",type:"text",className:"form-control",placeholder:"\u526f\u6a19",required:!0})]}),Object(m.jsx)(B.a,{children:Object(m.jsx)(F.a,{children:Object(m.jsx)("div",{className:"form-group",children:Object(m.jsxs)(Y.a,{as:"label",variant:"primary",hidden:""!==p,children:["\u4e0a\u50b3\u5716\u7247",Object(m.jsx)("input",{type:"file",name:"file",className:"upload-file",id:"file",onChange:function(e){console.log("Uploading");var t=x.storeId,n=new FileReader,a=e.target.files[0];n.onload=function(e){console.log(a),c(e.target.result);var n=new FormData;n.append("image",a),j(!0),fetch("https://lunchapi.hsuan.app/api/stores/"+t+"/images",{method:"POST",headers:{Accept:"application/json",Authorization:"Bearer ".concat(x.session)},body:n}).then((function(e){return e.ok?e.json():e.text().then((function(e){throw new Error(e)}))})).catch((function(e){console.log(e.message);var t=JSON.parse(e.message);window.alert("".concat(t.message,"\n\u8207\u4f3a\u670d\u5668\u9023\u7dda\u932f\u8aa4\uff0c\u8acb\u518d\u8a66\u4e00\u6b21\n\u5982\u679c\u554f\u984c\u7121\u6cd5\u89e3\u6c7a\uff0c\u8acb\u806f\u7d61\u7ba1\u7406\u54e1"))})).then((function(e){console.log(typeof e),b(e.result.data),j(!1)}))},n.readAsDataURL(a),console.log("Uploaded")},required:!0,hidden:!0})]})})})}),Object(m.jsx)(B.a,{children:Object(m.jsx)(F.a,{children:Object(m.jsxs)("center",{children:[Object(m.jsx)(W.a,{hidden:!1===i,animation:"border"}),Object(m.jsx)("br",{}),Object(m.jsx)("a",{href:"https://lunchapi.hsuan.app/"+p,target:"_blank",hidden:!n||i,rel:"noreferrer",children:"https://lunchapi.hsuan.app/"+p}),Object(m.jsx)("br",{}),Object(m.jsx)(Q.a.Image,{width:300,src:n&&!i?"https://lunchapi.hsuan.app/"+p:"https://via.placeholder.com/300x180?text=Product+Image",resizeMode:"contain"})]})})}),Object(m.jsx)(B.a,{children:Object(m.jsx)("div",{className:"h-100 align-items-center",children:Object(m.jsx)("div",{id:"placeToAdd"})})}),Object(m.jsx)(B.a,{children:Object(m.jsx)(F.a,{children:Object(m.jsx)("button",{className:"btn btn-primary btn-block",children:"\u9001\u51fa"})})})]})}var Le=function(e){Object(p.a)(n,e);var t=Object(b.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"componentDidMount",value:function(){window.scrollTo({top:0,behavior:"smooth"})}},{key:"render",value:function(){return Object(m.jsxs)(c.a.Fragment,{children:[Object(m.jsx)("h1",{style:{textAlign:"center"},children:"\u65b0\u589e\u83dc\u55ae"}),Object(m.jsxs)(_.a,{children:[Object(m.jsx)(Me,{}),Object(m.jsx)("br",{}),Object(m.jsx)(ze,{})]})]})}}]),n}(c.a.Component);var Ge=function(){var e=Object(a.useState)([]),t=Object(E.a)(e,2),n=t[0],r=(t[1],Object(a.useState)([])),s=Object(E.a)(r,2),i=s[0],o=s[1];return Object(a.useEffect)((function(){o(n)}),[n]),Object(m.jsxs)(c.a.Fragment,{children:[Object(m.jsx)("h1",{style:{textAlign:"center"},children:"\u9078\u9805\u8a2d\u5b9a"}),Object(m.jsxs)(_.a,{children:[Object(m.jsxs)("form",{children:[Object(m.jsxs)("div",{className:"form-group",children:[Object(m.jsx)("label",{children:"\u65b0\u9078\u9805"}),Object(m.jsx)("input",{id:"inputOption",type:"text",className:"form-control",placeholder:"\u9078\u9805\u540d"})]}),Object(m.jsx)(Y.a,{className:"btn btn-primary btn-block",children:"\u65b0\u589e"})]}),Object(m.jsx)("br",{}),i.map((function(e,t){return Object(m.jsx)(ce.a,{children:Object(m.jsxs)(ce.a.Body,{style:{display:"flex"},children:[Object(m.jsx)("div",{children:Object(m.jsx)(ce.a.Title,{children:e})}),Object(m.jsx)("div",{style:{marginLeft:"auto"},children:Object(m.jsx)(Y.a,{variant:"primary",onClick:function(){return e=t,void window.alert(e);var e},children:"\u522a\u9664"})})]})},e)}))]})]})},Ue=n(259),Je=n(43),He=n(44),We=function(e){Object(p.a)(n,e);var t=Object(b.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){return Object(m.jsxs)(ce.a,{className:["m-3","p-3"],children:[Object(m.jsx)("div",{hidden:!this.props.quota.exceed_quota,children:"\u5132\u5b58\u7a7a\u9593\u5df2\u6eff"}),Object(m.jsxs)("div",{children:["\u5132\u5b58\u7a7a\u9593\u5269\u9918 ",(this.props.quota.remain/1024e3).toFixed(2)," Mb / ",this.props.quota.total," Mb (\u5df2\u7528",((this.props.quota.total-this.props.quota.remain/1024e3)/this.props.quota.total*100).toFixed(2),"%)"]})]})}}]),n}(c.a.Component),Ke=function(e){Object(p.a)(n,e);var t=Object(b.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){var e,t,n;return Object(m.jsxs)("tr",{children:[Object(m.jsx)("td",{children:this.props.subscription.plan.name}),Object(m.jsx)("td",{children:this.props.subscription.plan.description}),Object(m.jsxs)("td",{children:[null!==(e=this.props.subscription.plan.disk_quota)&&void 0!==e?e:0," Mb"]}),Object(m.jsxs)("td",{children:[null!==(t=this.props.subscription.plan.promotion_quota)&&void 0!==t?t:0," \u9ede"]}),Object(m.jsx)("td",{children:null!==(n=this.props.subscription.expires_at)&&void 0!==n?n:"\u6c38\u4e45\u6709\u6548"})]})}}]),n}(c.a.Component),Ze=function(e){Object(p.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).generateECPay=a.generateECPay.bind(Object(v.a)(a)),a}return Object(h.a)(n,[{key:"generateECPay",value:function(){return"https://lunchapi.hsuan.app/"+this.props.storeId+"/"+this.props.plan.id+"/sendOrder"}},{key:"render",value:function(){var e,t;return Object(m.jsxs)("tr",{children:[Object(m.jsx)("td",{children:this.props.plan.name}),Object(m.jsx)("td",{children:this.props.plan.description}),Object(m.jsxs)("td",{children:[null!==(e=this.props.plan.disk_quota)&&void 0!==e?e:0," Mb"]}),Object(m.jsxs)("td",{children:[null!==(t=this.props.plan.promotion_quota)&&void 0!==t?t:0," \u9ede"]}),Object(m.jsx)("td",{children:Object(m.jsx)("a",{href:this.generateECPay(),rel:"noreferrer",className:"btn btn-primary",target:"_blank",children:"\u8cfc\u8cb7"})})]})}}]),n}(c.a.Component),Ve=new we,$e=new oe.a,Qe=function(e){Object(p.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={quota:{},loading:!1,subscriptions:[],plans:[]},a}return Object(h.a)(n,[{key:"getDiskQuota",value:function(e){var t=this;this.setState({loading:!0}),Ve.call("/stores/:store/disk_quota",{method:"GET",params:{store:e}},(function(e){console.log(e.remain),t.setState({quota:e,loading:!1})}))}},{key:"getSubscriptions",value:function(e){var t=this;this.setState({loading:!0}),Ve.call("/stores/:store/subscriptions",{method:"GET",params:{store:e}},(function(e){console.log(e),t.setState({subscriptions:e,loading:!1})}))}},{key:"getPlans",value:function(e){var t=this;this.setState({loading:!0}),Ve.call("/plans",{method:"GET",params:{store:e}},(function(e){console.log(e),t.setState({plans:e,loading:!1})}))}},{key:"componentDidMount",value:function(e){var t=this;window.scrollTo({top:0,behavior:"smooth"});var n=$e.get("storeId");n?(this.setState({storeId:n}),this.getDiskQuota(n),this.getSubscriptions(n),this.getPlans(n)):ee.a.fire({title:"\u932f\u8aa4!",text:"404 (STORE_NOT_FOUND)",icon:"error",confirmButtonText:"Ok"}).then((function(){return t.props.history.push("/settings/activate")}))}},{key:"render",value:function(){var e=this,t=this.state.subscriptions.map((function(e,t){return Object(m.jsx)(Ke,{subscription:e},e.id)})),n=this.state.plans.map((function(t,n){return Object(m.jsx)(Ze,{plan:t,storeId:e.state.storeId},t.id)}));return Object(m.jsxs)(c.a.Fragment,{children:[Object(m.jsxs)("h1",{style:{textAlign:"center"},children:["\u5ba2\u670d\u4e2d\u5fc3 ",Object(m.jsx)(Je.a,{icon:He.b})]}),Object(m.jsx)(B.a,{children:Object(m.jsx)(F.a,{children:Object(m.jsx)("center",{children:Object(m.jsx)(W.a,{animation:"border",hidden:!this.state.loading})})})}),Object(m.jsx)(B.a,{children:Object(m.jsx)(F.a,{children:Object(m.jsxs)(ce.a,{className:["m-3","p-3"],children:[Object(m.jsxs)("h5",{children:["\u60a8\u7684\u5e97\u5bb6ID\u70ba\uff1a ",Object(m.jsx)("b",{children:this.state.storeId})]}),Object(m.jsx)(We,{quota:this.state.quota}),Object(m.jsxs)(ce.a,{className:["m-3","p-3"],children:["\u60a8\u64c1\u6709\u7684\u65b9\u6848\u5217\u8868",Object(m.jsxs)(Ue.a,{children:[Object(m.jsx)("thead",{children:Object(m.jsxs)("tr",{children:[Object(m.jsx)("th",{children:"\u65b9\u6848\u540d\u7a31"}),Object(m.jsx)("th",{children:"\u8aaa\u660e"}),Object(m.jsx)("th",{children:"\u5132\u5b58\u5bb9\u91cf"}),Object(m.jsx)("th",{children:"\u5ba3\u50b3\u9ede\u6578"}),Object(m.jsx)("th",{children:"\u5230\u671f\u6642\u9593"})]})}),Object(m.jsx)("tbody",{children:t})]})]}),Object(m.jsxs)(ce.a,{className:["m-3","p-3"],children:["\u53ef\u8cfc\u8cb7\u7684\u65b9\u6848\u5217\u8868",Object(m.jsx)("div",{className:"alert alert-danger",children:"\u76ee\u524d\u70ba\u6e2c\u8a66\u968e\u6bb5\u8acb\u52ff\u4ed8\u6b3e"}),Object(m.jsxs)(Ue.a,{children:[Object(m.jsx)("thead",{children:Object(m.jsxs)("tr",{children:[Object(m.jsx)("th",{children:"\u65b9\u6848\u540d\u7a31"}),Object(m.jsx)("th",{children:"\u8aaa\u660e"}),Object(m.jsx)("th",{children:"\u5132\u5b58\u5bb9\u91cf"}),Object(m.jsx)("th",{children:"\u5ba3\u50b3\u9ede\u6578"}),Object(m.jsx)("th",{children:"\u8cfc\u8cb7"})]})}),Object(m.jsx)("tbody",{children:n})]})]})]})})})]})}}]),n}(c.a.Component),Ye=Object(d.h)(Qe),Xe=n(115),et=n(282),tt=n(147),nt=n(145),at=n(260),ct=n(142),rt=n(143),st=n.n(rt),it=n(144),ot=n.n(it),lt=(n(212),new we),jt=new oe.a;window.Pusher=n(213),window.Echo=new ct.a({broadcaster:"pusher",wsHost:"lunchapi.hsuan.app",wsPath:"/websockets",wsPort:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_ENDPOINT:"https://lunchapi.hsuan.app/api",REACT_APP_API_HOST:"https://lunchapi.hsuan.app",REACT_APP_WS_HOST:"lunchapi.hsuan.app",REACT_APP_WS_PATH:"/websockets",REACT_APP_PUSHER_APP_KEY:"test"}).REACT_APP_WS_PORT,disableStats:!0,key:"test",forceTLS:!1,authorizer:function(e,t){return{authorize:function(t,n){st()({method:"POST",url:"https://lunchapi.hsuan.app/api/broadcasting/auth",headers:{Authorization:"Bearer ".concat(jt.get("session"))},data:{socket_id:t,channel_name:e.name}}).then((function(e){n(!1,e.data)})).catch((function(e){n(!0,e)}))}}}});var dt=function(e){Object(p.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={transactions:[],rating:1},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(e){var t=new ot.a;if(window.scrollTo({top:0,behavior:"smooth"}),setTimeout((function(){t.start()}),5e3),jt.get("storeId")){var n=this;lt.call("/me",{method:"GET"},(function(e){window.Echo.private("user.".concat(e.id)).listen(".transaction.created",(function(e){var t,a;console.log(e),new Notification("".concat(e.transaction.id," ").concat(null===(t=e.transaction)||void 0===t||null===(a=t.product)||void 0===a?void 0:a.name)),n.setState((function(t){return{transactions:[e.transaction].concat(Object(Xe.a)(t.transactions))}}))}))}))}else;}},{key:"requestNotification",value:function(){Notification&&"granted"===Notification.permission?new Notification("\u6e2c\u8a66\u901a\u77e5"):Notification&&"denied"!==Notification.permission?Notification.requestPermission((function(e){Notification.permission!==e&&(Notification.permission=e),"granted"===e?new Notification("\u6e2c\u8a66\u901a\u77e5"):alert("\u4f60\u4e0d\u958b\u901a\u77e5\u6211\u4e5f\u4e0d\u80fd\u63d0\u9192\u4f60")})):alert("\u4f60\u4e0d\u958b\u901a\u77e5\u6211\u4e5f\u4e0d\u80fd\u63d0\u9192\u4f60")}},{key:"transactionsToast",value:function(){return this.state.transactions.map((function(e,t){var n,a,c;return Object(m.jsxs)(et.a,{children:[Object(m.jsx)(tt.a,{children:Object(m.jsxs)("strong",{className:"mr-auto",children:["(",e.id.substring(0,5),") ",null===e||void 0===e||null===(n=e.product)||void 0===n?void 0:n.name]})}),Object(m.jsxs)(nt.a,{children:[null===e||void 0===e||null===(a=e.product)||void 0===a?void 0:a.name," x ",null===e||void 0===e?void 0:e.qty," ",Object(m.jsx)("br",{}),null===e||void 0===e||null===(c=e.product)||void 0===c?void 0:c.description]})]})}))}},{key:"handleRate",value:function(e){this.setState({rating:e}),lt.call("/products/:product/rate",{params:{product:""}},(function(e){console.log(e)}))}},{key:"rating",value:function(){var e=this;return Object(m.jsxs)(F.a,{children:[Object(m.jsx)(at.a,{children:Object(Xe.a)(Array(6).keys()).slice(1).map((function(t){return t<=e.state.rating?Object(m.jsx)(Y.a,{variant:"primary",className:["text-lg"],onClick:e.handleRate.bind(e,t),"data-star":t,children:Object(m.jsx)(Je.a,{icon:He.c})},t):Object(m.jsx)(Y.a,{variant:"secondary",className:["text-lg"],onClick:e.handleRate.bind(e,t),"data-star":t,children:Object(m.jsx)(Je.a,{icon:He.c})},t)}))}),"\xa0",Object(m.jsx)(Y.a,{variant:"danger",className:["text-lg"],onClick:this.handleRate.bind(this,-1),children:Object(m.jsx)(Je.a,{icon:He.e})})]})}},{key:"render",value:function(){return Object(m.jsxs)(c.a.Fragment,{children:[Object(m.jsxs)("h1",{style:{textAlign:"center"},children:["\u8a02\u55ae\u5217\u8868 ",Object(m.jsx)(Je.a,{icon:He.c})]}),Object(m.jsx)(B.a,{children:Object(m.jsx)(F.a,{children:Object(m.jsx)("center",{children:Object(m.jsx)(W.a,{animation:"border",hidden:!this.state.loading})})})}),Object(m.jsx)(Y.a,{"data-intro":"Hello step one!",onClick:this.requestNotification,children:"\u50b3\u9001\u901a\u77e5"}),Object(m.jsx)(B.a,{children:this.rating()}),Object(m.jsxs)(B.a,{children:[Object(m.jsx)(F.a,{children:this.transactionsToast()}),Object(m.jsxs)(F.a,{children:[this.state.transactions.length,JSON.stringify(this.state.transactions)]})]})]})}}]),n}(c.a.Component);function ut(){var e=Object(a.useState)(!0),t=Object(E.a)(e,2),n=t[0],r=t[1],s=Object(a.useState)(),i=Object(E.a)(s,2),d=i[0],u=i[1],h=new k.a,p=h.getAll(),b=function(){var e=Object(l.a)(o.a.mark((function e(){var t,n,a,c,s,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t="https://lunchapi.hsuan.app/api/stores/"+p.storeId+"/transactions",e.next=4,fetch(t,{method:"GET",headers:{Accept:"application/json",Authorization:"Bearer ".concat(p.session)}});case 4:return n=e.sent,e.next=7,n.json();case 7:for(i in a=e.sent,console.log(a),c={},console.log(a),a.map((function(e){return void 0===c[e.product_id]?c[e.product_id]=1:c[e.product_id]++,null})),s=[],c)console.log(c[i]),console.log(i),s.push({name:i,count:c[i]});u(s),r(!1),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(0),h.set("alert","\u64cd\u4f5c\u932f\u8aa4\uff0c\u8acb\u91cd\u8a66",{path:"/"}),document.location.href="/";case 22:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){return b()}),[]),Object(m.jsxs)(c.a.Fragment,{children:[Object(m.jsx)("center",{children:Object(m.jsx)(W.a,{animation:"border",hidden:!n})}),Object(m.jsx)("center",{children:Object(m.jsx)("h1",{children:"\u5df2\u8a02\u9910\u540d\u55ae"})}),Object(m.jsx)(_.a,{children:d?d.map((function(e){return Object(m.jsx)(ce.a,{children:Object(m.jsxs)(ce.a.Body,{style:{display:"flex"},children:[Object(m.jsxs)("div",{children:[Object(m.jsx)(ce.a.Title,{children:e.name}),Object(m.jsxs)(ce.a.Text,{children:[e.count,"\u4efd"]})]}),Object(m.jsx)("div",{style:{marginLeft:"auto"},children:Object(m.jsx)(Y.a,{variant:"primary",as:j.b,to:{pathname:"/booked/detailed/".concat(e.name)},children:"\u7acb\u5373\u67e5\u770b"})})]})},e.id)})):Object(m.jsxs)(c.a.Fragment,{children:[Object(m.jsx)("br",{}),Object(m.jsx)("h2",{style:{textAlign:"center"},children:"\u67e5\u7121\u8cc7\u6599"})]})}),Object(m.jsx)("br",{})]})}function ht(e){var t=Object(a.useState)(!0),n=Object(E.a)(t,2),r=n[0],s=n[1],i=Object(a.useState)([]),j=Object(E.a)(i,2),d=j[0],u=j[1],h=Object(a.useState)(""),p=Object(E.a)(h,2),b=p[0],O=p[1],x=new k.a,f=x.getAll(),v=function(){var t=Object(l.a)(o.a.mark((function t(){var n,a,c,r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="https://lunchapi.hsuan.app/api/stores/"+f.storeId+"/transactions",t.next=3,fetch(n,{method:"GET",headers:{Accept:"application/json",Authorization:"Bearer ".concat(f.session)}});case 3:return a=t.sent,t.next=6,a.json();case 6:return c=t.sent,r=[],c.map((function(t){t.product_id===e.match.params.itemId&&r.push(t)})),t.abrupt("return",r);case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),g=function(){var t=Object(l.a)(o.a.mark((function t(){var n,a,c,r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="https://lunchapi.hsuan.app/api/stores/"+f.storeId+"/products",t.next=3,fetch(n,{method:"GET",headers:{Accept:"application/json",Authorization:"Bearer ".concat(f.session)}});case 3:return a=t.sent,t.next=6,a.json();case 6:return c=t.sent,r="temp",c.map((function(t){t.id===e.match.params.itemId&&(r=t.name)})),t.abrupt("return",r);case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),y=function(){var t=Object(l.a)(o.a.mark((function t(){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Promise.all([v(),g(e.match.params.itemId)]);case 3:n=t.sent,s(!1),O(n[1]),u(n[0]),console.log(n[0]),t.next=15;break;case 10:t.prev=10,t.t0=t.catch(0),window.alert(t.t0),x.set("alert","\u8b80\u53d6\u932f\u8aa4\uff0c\u6b63\u5728\u8fd4\u56de\u9996\u9801",{path:"/"}),document.location.href="/";case 15:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(){return t.apply(this,arguments)}}();var w=function(){var e=Object(l.a)(o.a.mark((function e(t,n){var a,c,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=null,e.prev=1,e.next=4,fetch(t,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(f.session)},body:JSON.stringify({status:n})});case 4:return c=e.sent,e.next=7,c.json();case 7:r=e.sent,console.log(r),a=!!c.ok,e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),window.alert("\u72c0\u614b\u66f4\u65b0\u5931\u6557\uff1a".concat(e.t0)),a=!1;case 16:return e.abrupt("return",a);case 17:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t,n){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){return y()})),Object(m.jsxs)(c.a.Fragment,{children:[Object(m.jsxs)("center",{children:[Object(m.jsx)("h1",{children:"\u8a73\u7d30\u8cc7\u6599"}),Object(m.jsxs)("h2",{children:["\u5546\u54c1\u540d\u7a31\uff1a",b," ",Object(m.jsx)(W.a,{animation:"border",hidden:!r})]})]}),Object(m.jsx)(_.a,{children:d?d.map((function(e){return Object(m.jsx)(ce.a,{children:Object(m.jsxs)(ce.a.Body,{style:{display:"flex"},children:[Object(m.jsxs)("div",{children:[Object(m.jsxs)(ce.a.Title,{children:["\u4ea4\u6613\u7de8\u865f\uff1a",e.id]}),Object(m.jsxs)(ce.a.Text,{children:["\u5099\u8a3b\uff1a",e.comment]})]}),Object(m.jsxs)("div",{style:{marginLeft:"auto"},children:[Object(m.jsx)(z.a,{variant:"contained",color:"PREPARE"===e.status?"primary":"",onClick:function(){var t;t=e.id,w("https://lunchapi.hsuan.app/api/transactions/"+t,"PREPARE")},children:Object(m.jsx)(Je.a,{icon:He.d})}),Object(m.jsx)(z.a,{variant:"contained",color:"OK"===e.status?"primary":"",onClick:function(){var t;t=e.id,w("https://lunchapi.hsuan.app/api/transactions/"+t,"OK")},children:Object(m.jsx)(Je.a,{icon:He.a})}),Object(m.jsx)(z.a,{variant:"contained",color:"DONE"===e.status?"primary":"",onClick:function(){var t;t=e.id,w("https://lunchapi.hsuan.app/api/transactions/"+t,"DONE")},children:Object(m.jsx)(Je.a,{icon:He.f})})]})]})},e.id)})):Object(m.jsxs)(c.a.Fragment,{children:[Object(m.jsx)("br",{}),Object(m.jsx)("h2",{style:{textAlign:"center"},children:"\u67e5\u7121\u8cc7\u6599"})]})})]})}var pt=n(265),bt=n(250),Ot=n(271),xt=n(149),mt=n(116),ft=n(266),vt=n(106),gt=n(281),yt=n(261),wt=n(262),kt=n(263),St=n(264),Tt=n(77);function Nt(e){var t=Object(a.useState)(!0),n=Object(E.a)(t,2),c=n[0],r=n[1],s=new k.a,i=new we;function j(){r(!1),navigator.geolocation.getCurrentPosition(d,u,{enableHighAccuracy:!0})}function d(e){if("undefined"===typeof s.get("fingerprint")){var t=Tt.a();Object(l.a)(o.a.mark((function n(){var a,c,r;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t;case 2:return a=n.sent,n.next=5,a.get();case 5:c=n.sent,r=c.visitorId,s.set("fingerprint",r),i.call("/log/geo",{method:"POST",body:{lat:e.coords.latitude,lng:e.coords.longitude,fingerprint:r}});case 9:case"end":return n.stop()}}),n)})))()}else i.call("/log/geo",{method:"POST",body:{lat:e.coords.latitude,lng:e.coords.longitude,fingerprint:s.get("fingerprint")}})}function u(e){alert("\u4f4d\u7f6e\u932f\u8aa4")}return Object(m.jsx)(a.Fragment,{children:Object(m.jsxs)(gt.a,{open:e.open&&c,onClose:j,"aria-labelledby":"form-dialog-title",children:[Object(m.jsx)(yt.a,{id:"form-dialog-title",children:"\u4f4d\u7f6e"}),Object(m.jsx)(wt.a,{children:Object(m.jsx)(kt.a,{children:"\u8acb\u958b\u555f\u4f4d\u7f6e\u6b0a\u9650\u8b93\u641c\u5c0b\u7d50\u679c\u66f4\u7cbe\u6e96"})}),Object(m.jsx)(St.a,{children:Object(m.jsx)(z.a,{onClick:j,color:"primary",children:"\u597d"})})]})})}var Ct=new oe.a,It=new we,At=Object(pt.a)((function(e){return{root:{flexGrow:1},paper:{padding:e.spacing(2),margin:"auto",maxWidth:500},image:{width:128,height:128},img:{margin:"auto",display:"block",maxWidth:"100%",maxHeight:"100%"},miniIcon:{width:60,height:60}}}));function Et(e){var t,n,a,c=At(),r=Object(d.f)();return Object(m.jsx)("div",{className:c.root,children:Object(m.jsx)(bt.a,{className:c.paper,elevation:3,children:Object(m.jsxs)(ge.a,{container:!0,spacing:2,children:[Object(m.jsxs)(ge.a,{item:!0,xs:12,sm:!0,container:!0,children:[Object(m.jsxs)(ge.a,{item:!0,xs:!0,container:!0,direction:"column",spacing:2,children:[Object(m.jsxs)(ge.a,{item:!0,xs:!0,children:[Object(m.jsxs)(Ot.a,{fontSize:1,color:vt.a,hidden:!e.product.weight,children:[Object(m.jsx)(ft.a,{style:{fontSize:12}}),"\xa0\u5ee3\u544a"]}),Object(m.jsx)(xt.a,{style:{cursor:"pointer",color:"green"},gutterBottom:!0,variant:"h6",as:j.b,onClick:function(){return r.push("/purchase/".concat(e.product.store_id,"/").concat(e.product.id))},children:null===e||void 0===e||null===(t=e.product)||void 0===t?void 0:t.name}),Object(m.jsx)(xt.a,{variant:"body2",gutterBottom:!0,children:null===e||void 0===e||null===(n=e.product)||void 0===n?void 0:n.description}),Object(m.jsx)(xt.a,{variant:"body2",color:"textSecondary",children:null===e||void 0===e||null===(a=e.product)||void 0===a?void 0:a.store_name})]}),Object(m.jsx)(ge.a,{item:!0,children:Object(m.jsx)(Ot.a,{component:"fieldset",mb:3,borderColor:"transparent",children:e.product.weighted_ratings?Object(m.jsx)(fe.a,{name:"read-only",value:parseFloat(e.product.weighted_ratings),readOnly:!0}):Object(m.jsx)(fe.a,{name:"read-only",value:parseFloat(e.product.ratings_avg),readOnly:!0})})})]}),Object(m.jsx)(ge.a,{item:!0,children:Object(m.jsxs)(xt.a,{variant:"subtitle1",children:[e.product.price,"\u5143"]})})]}),Object(m.jsx)(ge.a,{item:!0,children:Object(m.jsx)(mt.a,{className:c.image,children:Object(m.jsx)("img",{className:c.img,alt:e.product.name,src:"https://lunchapi.hsuan.app/"+e.product.image})})})]})})})}function Pt(){var e=Object(a.useRef)(!0),t=Object(a.useState)(""),n=Object(E.a)(t,2),r=n[0],s=n[1],i=Object(a.useState)([]),j=Object(E.a)(i,2),u=j[0],h=j[1],p=Object(a.useState)(!1),b=Object(E.a)(p,2),O=b[0],x=b[1],f=Object(a.useState)(!1),v=Object(E.a)(f,2),g=v[0],y=v[1],w=Object(d.g)(),k=c.a.useCallback((function(e){var t;x(!0),t="string"===typeof e?e:r,It.call("/products/query",{method:"POST",body:{term:t}},(function(e){h(e),x(!1)}))}),[r]);Object(a.useEffect)((function(){if(e.current){e.current=!1,window.scrollTo({top:0,behavior:"smooth"});var t=new URLSearchParams(w.search).get("q");s(t),k(t),navigator.permissions.query({name:"geolocation"}).then((function(e){"granted"===e.state?navigator.geolocation.getCurrentPosition((function(e){if("undefined"===typeof Ct.get("fingerprint")){var t=Tt.a();Object(l.a)(o.a.mark((function n(){var a,c,r;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t;case 2:return a=n.sent,n.next=5,a.get();case 5:c=n.sent,r=c.visitorId,Ct.set("fingerprint",r),It.call("/log/geo",{method:"POST",body:{lat:e.coords.latitude,lng:e.coords.longitude,fingerprint:r}});case 9:case"end":return n.stop()}}),n)})))()}else It.call("/log/geo",{method:"POST",body:{lat:e.coords.latitude,lng:e.coords.longitude,fingerprint:Ct.get("fingerprint")}})}),(function(e){alert("\u4f4d\u7f6e\u932f\u8aa4!")}),{enableHighAccuracy:!0}):("undefined"===typeof Ct.get("lastGEO")||Ct.get("lastGEO")&&Ct.get("lastGEO")-Date.now()>=72e5)&&(y(!0),Ct.set("lastGEO",Date.now()))}))}}),[w.search,k]);var N=u.map((function(e,t){return Object(m.jsxs)("div",{children:[Object(m.jsx)(Et,{product:e}),Object(m.jsx)("br",{})]},e.id)}));return Object(m.jsxs)(c.a.Fragment,{children:[Object(m.jsx)(ve.a,{hidden:!O}),Object(m.jsx)("h1",{style:{textAlign:"center"},children:"\u641c\u5c0b\u7d50\u679c"}),Object(m.jsxs)(_.a,{children:[Object(m.jsx)(S.a,{id:"filled-full-width",label:"\u641c\u5c0b\u98df\u7269",style:{margin:8},placeholder:"\u60f3\u5403\u7684\u6771\u897f",helperText:"\u60f3\u5403\u7684\u6771\u897f",fullWidth:!0,value:r,margin:"normal",InputLabelProps:{shrink:!0},onChange:function(e){s(e.target.value)},variant:"filled",InputProps:{endAdornment:Object(m.jsx)(T.a,{onClick:k,children:Object(m.jsx)(C.a,{})})}}),Object(m.jsx)("h5",{style:{textAlign:"center"},hidden:O||0!==u.length,children:"\u76ee\u524d\u7121\u76f8\u95dc\u8cc7\u6599"}),N,Object(m.jsx)(Nt,{open:g})]})]})}var _t=n(146),Bt=n(273),Ft=n(267);function qt(e){var t=e.children,n=e.value,a=e.index,c=Object(_t.a)(e,["children","value","index"]);return Object(m.jsx)("div",Object(ye.a)(Object(ye.a)({role:"tabpanel",hidden:n!==a,id:"vertical-tabpanel-".concat(a),"aria-labelledby":"vertical-tab-".concat(a)},c),{},{children:n===a&&Object(m.jsx)(Ot.a,{p:3,children:Object(m.jsx)(xt.a,{children:t})})}))}function Rt(e){return{id:"vertical-tab-".concat(e),"aria-controls":"vertical-tabpanel-".concat(e)}}var Dt=Object(pt.a)((function(e){return{root:{flexGrow:1,backgroundColor:e.palette.background.paper,display:"flex",height:224},tabs:{borderRight:"1px solid ".concat(e.palette.divider)}}}));function Mt(){var e=Dt(),t=c.a.useState(0),n=Object(E.a)(t,2),a=n[0],r=n[1];return Object(m.jsxs)(c.a.Fragment,{children:[Object(m.jsx)("h1",{style:{textAlign:"center"},children:"\u958b\u767c\u8005\u8a2d\u5b9a"}),Object(m.jsxs)("div",{className:e.root,children:[Object(m.jsxs)(Bt.a,{orientation:"vertical",variant:"scrollable",value:a,onChange:function(e,t){r(t)},"aria-label":"Vertical tabs example",className:e.tabs,children:[Object(m.jsx)(Ft.a,Object(ye.a)({label:"Session \u8a2d\u5b9a"},Rt(0))),Object(m.jsx)(Ft.a,Object(ye.a)({label:"Item Two"},Rt(1))),Object(m.jsx)(Ft.a,Object(ye.a)({label:"Item Three"},Rt(2))),Object(m.jsx)(Ft.a,Object(ye.a)({label:"Item Four"},Rt(3))),Object(m.jsx)(Ft.a,Object(ye.a)({label:"Item Five"},Rt(4))),Object(m.jsx)(Ft.a,Object(ye.a)({label:"Item Six"},Rt(5))),Object(m.jsx)(Ft.a,Object(ye.a)({label:"Item Seven"},Rt(6)))]}),Object(m.jsxs)(qt,{value:a,index:0,children:["\u8a2d\u5b9a\u8a2d\u5b9a",Object(m.jsx)("br",{}),Object(m.jsx)(S.a,{id:"term",value:"",label:"API Token",variant:"outlined",size:"small",InputProps:{endAdornment:Object(m.jsx)(T.a,{onClick:this.searchProduct,children:Object(m.jsx)(C.a,{})})}})]}),Object(m.jsx)(qt,{value:a,index:1,children:"Item Two"}),Object(m.jsx)(qt,{value:a,index:2,children:"Item Three"}),Object(m.jsx)(qt,{value:a,index:3,children:"Item Four"}),Object(m.jsx)(qt,{value:a,index:4,children:"Item Five"}),Object(m.jsx)(qt,{value:a,index:5,children:"Item Six"}),Object(m.jsx)(qt,{value:a,index:6,children:"Item Seven"})]})]})}var zt=n(268),Lt=n(275),Gt=new we,Ut=[{min:0,max:100,name:"\u4e00\u822c\u6703\u54e1",color:"#eddcad"},{min:101,max:249,name:"\u7da0\u661f\u6703\u54e1",color:"#44f2a4"},{min:250,max:599,name:"\u7da0\u947d\u6703\u54e1",color:"#b1f0d4"},{min:600,max:1e3,name:"\u85cd\u661f\u6703\u54e1",color:"#4a98ff"},{min:1001,max:1999,name:"\u85cd\u947d\u6703\u54e1",color:"#aec4e6"},{min:2e3,max:3449,name:"\u9280\u661f\u6703\u54e1",color:"#d9d9d9"},{min:3500,max:9999,name:"\u91d1\u661f\u6703\u54e1",color:"#ece00a"}];function Jt(){var e=Object(a.useState)(!0),t=Object(E.a)(e,2),n=t[0],r=t[1],s=Object(a.useState)(0),i=Object(E.a)(s,2),j=i[0],d=i[1],u=Object(a.useState)(""),h=Object(E.a)(u,2),p=h[0],b=h[1],O=Object(a.useRef)(HTMLInputElement),x=/^09\d{2}-?\d{3}-?\d{3}$/,f=function(){var e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r(!0),e.next=3,Gt.call("/user/level",{},(function(e){return d(e.level)}));case 3:return e.next=5,Gt.call("/user/data",{},(function(e){O.current.value=e.phone,r(!1)}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function v(e){return Object(m.jsxs)(Ot.a,{position:"relative",display:"inline-flex",border:1,className:"m-3 pt-2",borderRadius:5,children:[Object(m.jsx)(zt.a,{variant:"determinate",style:{color:e.color},value:(e.credit-e.levelMin)/(e.levelMax-e.levelMin)*100,size:e.size||"8rem"}),Object(m.jsxs)(Ot.a,{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",children:[Object(m.jsx)(xt.a,{variant:"caption",component:"div",color:"textPrimary",children:"".concat(e.levelName)}),Object(m.jsx)(xt.a,{variant:"caption",component:"div",color:"textSecondary",children:"".concat(Math.round(e.credit),"/").concat(Math.round(e.levelMax))})]})]})}return Object(a.useEffect)((function(){f().then()}),[]),Object(m.jsxs)(c.a.Fragment,{children:[Object(m.jsx)(ve.a,{hidden:!n}),Object(m.jsx)("h1",{style:{textAlign:"center"},children:"\u500b\u4eba\u6a94\u6848"}),Object(m.jsx)(ge.a,{container:!0,children:Object(m.jsxs)(ge.a,{item:!0,xs:12,children:[Object(m.jsx)(bt.a,{elevation:3,className:"m-3 p-3",children:function(e){var t;return Ut.every((function(n,a){return!(n.min<=e&&e<=n.max)||(t=Object(m.jsx)(v,{credit:e,levelMin:n.min,levelMax:n.max,levelName:n.name,color:n.color}),!1)})),t}(j)}),Object(m.jsxs)(bt.a,{elevation:3,className:"m-3 p-3",children:[Object(m.jsx)(Lt.a,{severity:"info",children:"\u88dc\u9f4a\u6703\u54e1\u8cc7\u6599\u5c31\u53ef\u4ee5\u7372\u5f97\u6703\u54e1\u7a4d\u5206\u734e\u52f5\u5594~"}),Object(m.jsx)(S.a,{className:"m-3",label:"\u60a8\u7684\u624b\u6a5f",inputRef:O,error:""!==p,helperText:p,variant:"standard",InputLabelProps:{shrink:!0}}),Object(m.jsx)("br",{}),Object(m.jsx)(z.a,{className:"m-3",onClick:function(){if(!O.current.value.match(x))return b("\u8acb\u8f38\u5165\u6b63\u78ba\u7684\u624b\u6a5f\u865f\u78bc");Gt.call("/user/data",{method:"POST",body:{phone:O.current.value}},(function(e){e.levelUp&&ee.a.fire({title:"\u6210\u529f!",text:"\u586b\u5beb\u5b8c\u7562\uff0c\u5df2\u8d08\u9001\u6703\u54e1\u7a4d\u5206",icon:"success",confirmButtonText:"Ok"}),"success"===e.status&&b(""),f().then()}))},variant:"contained",color:"primary",children:"\u66f4\u65b0"})]})]})})]})}var Ht=new we,Wt=new oe.a;var Kt=function(){var e=Object(a.useRef)(!0);return Object(a.useEffect)((function(){if(e.current){var t=Tt.a();Object(l.a)(o.a.mark((function e(){var n,a,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:return n=e.sent,e.next=5,n.get();case 5:a=e.sent,c=a.visitorId,Wt.set("fingerprint",c),Ht.call("/log",{method:"POST",body:{fingerprint:c,location:window.location.href}});case 9:case"end":return e.stop()}}),e)})))(),e.current=!1}})),Object(m.jsxs)(j.a,{children:[Object(m.jsx)(f,{}),Object(m.jsx)(A,{}),Object(m.jsx)(P,{}),Object(m.jsxs)(d.c,{children:[Object(m.jsx)(d.a,{path:"/login",component:$}),Object(m.jsx)(d.a,{path:"/booked/detailed/:itemId",component:ht}),Object(m.jsx)(d.a,{path:"/booked",component:ut}),Object(m.jsx)(d.a,{path:"/query",component:Pt}),Object(m.jsx)(d.a,{path:"/profile",component:Jt}),Object(m.jsx)(d.a,{path:"/restaurant",component:me}),Object(m.jsx)(d.a,{path:"/settings",component:Oe}),Object(m.jsx)(d.a,{path:"/purchase/:store/:product",component:ae}),Object(m.jsx)(d.a,{path:"/order/:storeId",component:se}),Object(m.jsx)(d.a,{path:"/history",component:Te}),Object(m.jsx)(d.a,{path:"/service",component:Ye}),Object(m.jsx)(d.a,{path:"/sells/test",component:dt}),Object(m.jsx)(d.a,{path:"/config/new/option",component:Ge}),Object(m.jsx)(d.a,{path:"/config/store",component:Ne}),Object(m.jsx)(d.a,{path:"/config/menu/new",component:Le}),Object(m.jsx)(d.a,{path:"/config/menu",component:Ae}),Object(m.jsx)(d.a,{path:"/config/advanced/:product",component:Pe}),Object(m.jsx)(d.a,{path:"/privacy",component:Be}),Object(m.jsx)(d.a,{path:"/COC",component:_e}),Object(m.jsx)(d.a,{path:"/signup",component:qe}),Object(m.jsx)(d.a,{path:"/feedback",component:De}),Object(m.jsx)(d.a,{path:"/dev",component:Mt}),Object(m.jsx)(d.a,{path:"/",component:H})]}),Object(m.jsx)(q,{})]})},Zt=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,285)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),a(e),c(e),r(e),s(e)}))};s.a.render(Object(m.jsx)(c.a.StrictMode,{children:Object(m.jsx)(Kt,{})}),document.getElementById("root")),Zt()},34:function(e){e.exports=JSON.parse('{"baseURL":"https://lunchapi.hsuan.app/api/","project":"https://tnfsa.github.io","gmailSuffix":"gm.tnfsh.tn.edu.tw","docRoot":"https://lunchdoc.tnfsa.org/","googleCloudPlatformId":"1081268402297-stef8id8lhkhjd7lvh1de82eubmcn3re","version":"0.3.0 Alpha \u5167\u6e2c\u7248"}')}},[[214,1,2]]]);
//# sourceMappingURL=main.37f14ada.chunk.js.map